# 常微分方程的数值求法例题讲解

## **问题描述**

考虑以下常微分方程的初值问题：

$$
\begin{cases}
y' = y - \frac{2x}{y}, \quad 0 < x < 1 \\
y(0) = 1
\end{cases}
$$

步长 $h = 0.1$，计算区间 $[0, 1]$ 上的数值解。

---

## **1. 显式欧拉方法**

### **公式**

$$
y_{n+1} = y_n + h \cdot f(x_n, y_n)
$$

### **计算过程**

* **初始化**：

  * $x_0 = 0$, $y_0 = 1$。
* **迭代计算**：

  * 对于 $n = 0, 1, 2, \dots, 9$，计算：

    $$
    y_{n+1} = y_n + h \cdot f(x_n, y_n)
    $$

    并更新 $x_{n+1} = x_n + h$。

### **结果**

|$n$|$x_n$|$y_n$ (显式欧拉)|
| ----| -----| -------------|
|0|0.0|1.0000|
|1|0.1|1.1000|
|2|0.2|1.1918|
|3|0.3|1.2774|
|4|0.4|1.3582|
|5|0.5|1.4351|
|6|0.6|1.5085|
|7|0.7|1.5786|
|8|0.8|1.6458|
|9|0.9|1.7102|
|10|1.0|1.7720|

---

## **2. 隐式欧拉方法**

### **公式**

$$
y_{n+1} = y_n + h \cdot f(x_{n+1}, y_{n+1})
$$

### **计算过程**

* **初始化**：

  * $x_0 = 0$, $y_0 = 1$。
* **迭代计算**：

  * 对于 $n = 0, 1, 2, \dots, 9$，通过迭代法解方程：

    $$
    y_{n+1} = y_n + h \cdot f(x_{n+1}, y_{n+1})
    $$

    并更新 $x_{n+1} = x_n + h$。

### **结果**

|$n$|$x_n$|$y_n$ (隐式欧拉)|
| ----| -----| -------------|
|0|0.0|1.0000|
|1|0.1|1.0959|
|2|0.2|1.1841|
|3|0.3|1.2662|
|4|0.4|1.3434|
|5|0.5|1.4164|
|6|0.6|1.4856|
|7|0.7|1.5513|
|8|0.8|1.6137|
|9|0.9|1.6730|
|10|1.0|1.7293|

---

## **3. 改进的欧拉方法**

### **公式**

$$
\begin{cases}
y_p = y_n + h \cdot f(x_n, y_n) \\
y_{n+1} = y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, y_p) \right]
\end{cases}
$$

### **计算过程**

* **初始化**：

  * $x_0 = 0$, $y_0 = 1$。
* **迭代计算**：

  * 对于 $n = 0, 1, 2, \dots, 9$，计算：

    * 预报值：$y_p = y_n + h \cdot f(x_n, y_n)$
    * 校正值：$y_{n+1} = y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, y_p) \right]$  
      并更新 $x_{n+1} = x_n + h$。

### **结果**

|$n$|$x_n$|$y_n$ (改进欧拉)|
| ----| -----| -------------|
|0|0.0|1.0000|
|1|0.1|1.0959|
|2|0.2|1.1841|
|3|0.3|1.2662|
|4|0.4|1.3434|
|5|0.5|1.4164|
|6|0.6|1.4856|
|7|0.7|1.5513|
|8|0.8|1.6137|
|9|0.9|1.6730|
|10|1.0|1.7293|

---

## **4. 二阶龙格-库塔方法**

### **公式**

$$
\begin{cases}
k_1 = f(x_n, y_n) \\
k_2 = f(x_n + h, y_n + h \cdot k_1) \\
y_{n+1} = y_n + \frac{h}{2} (k_1 + k_2)
\end{cases}
$$

### **计算过程**

* **初始化**：

  * $x_0 = 0$, $y_0 = 1$。
* **迭代计算**：

  * 对于 $n = 0, 1, 2, \dots, 9$，计算：

    * $k_1 = f(x_n, y_n)$
    * $k_2 = f(x_n + h, y_n + h \cdot k_1)$
    * $y_{n+1} = y_n + \frac{h}{2} (k_1 + k_2)$  
      并更新 $x_{n+1} = x_n + h$。

### **结果**

|$n$|$x_n$|$y_n$ (二阶龙格-库塔)|
| ----| -----| ------------------|
|0|0.0|1.0000|
|1|0.1|1.0959|
|2|0.2|1.1841|
|3|0.3|1.2662|
|4|0.4|1.3434|
|5|0.5|1.4164|
|6|0.6|1.4856|
|7|0.7|1.5513|
|8|0.8|1.6137|
|9|0.9|1.6730|
|10|1.0|1.7293|

---

## **5. 四阶龙格-库塔方法**

### **公式**

$$
\begin{cases}
k_1 = f(x_n, y_n) \\
k_2 = f(x_n + \frac{h}{2}, y_n + \frac{h}{2} \cdot k_1) \\
k_3 = f(x_n + \frac{h}{2}, y_n + \frac{h}{2} \cdot k_2) \\
k_4 = f(x_n + h, y_n + h \cdot k_3) \\
y_{n+1} = y_n + \frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)
\end{cases}
$$

### **计算过程**

* **初始化**：

  * $x_0 = 0$, $y_0 = 1$。
* **迭代计算**：

  * 对于 $n = 0, 1, 2, \dots, 9$，计算：

    * $k_1 = f(x_n, y_n)$
    * $k_2 = f(x_n + \frac{h}{2}, y_n + \frac{h}{2} \cdot k_1)$
    * $k_3 = f(x_n + \frac{h}{2}, y_n + \frac{h}{2} \cdot k_2)$
    * $k_4 = f(x_n + h, y_n + h \cdot k_3)$
    * $y_{n+1} = y_n + \frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)$  
      并更新 $x_{n+1} = x_n + h$。

### **结果**

|$n$|$x_n$|$y_n$ (四阶龙格-库塔)|
| ----| -----| ------------------|
|0|0.0|1.0000|
|1|0.1|1.0954|
|2|0.2|1.1832|
|3|0.3|1.2649|
|4|0.4|1.3416|
|5|0.5|1.4142|
|6|0.6|1.4832|
|7|0.7|1.5492|
|8|0.8|1.6125|
|9|0.9|1.6733|
|10|1.0|1.7321|

---

## **总结**

* **显式欧拉方法**：计算简单，但精度低。
* **隐式欧拉方法**：计算复杂，但稳定性好。
* **改进的欧拉方法**：精度高于显式欧拉，计算量适中。
* **二阶龙格-库塔方法**：精度较高，计算量适中。
* **四阶龙格-库塔方法**：精度最高，但计算量最大。

‍
