# 线性方程组直接法求解

## **问题描述**

求解以下线性方程组：

$$
\begin{cases}
10x_1 - x_2 + 2x_3 = 6 \\
-x_1 + 11x_2 - x_3 + 3x_4 = 25 \\
2x_1 - x_2 + 10x_3 - x_4 = -11 \\
3x_2 - x_3 + 8x_4 = 15
\end{cases}
$$

---

## **1. 约当消去法**

### **计算过程**

1. **初始化**：

    * 将方程组写成增广矩阵形式：

      $$
      \begin{bmatrix}
      10 & -1 & 2 & 0 & | & 6 \\
      -1 & 11 & -1 & 3 & | & 25 \\
      2 & -1 & 10 & -1 & | & -11 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
2. **第一步**（消去 $x_1$）：

    * 将第一行除以 10：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      -1 & 11 & -1 & 3 & | & 25 \\
      2 & -1 & 10 & -1 & | & -11 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
    * 用第一行消去其他行的 $x_1$：

      * 第二行：$R_2 + R_1 \rightarrow R_2$
      * 第三行：$R_3 - 2R_1 \rightarrow R_3$
      * 第四行：$R_4$ 不变

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 10.9 & -0.8 & 3 & | & 25.6 \\
      0 & -0.8 & 9.6 & -1 & | & -12.2 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
3. **第二步**（消去 $x_2$）：

    * 将第二行除以 10.9：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & -0.8 & 9.6 & -1 & | & -12.2 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
    * 用第二行消去其他行的 $x_2$：

      * 第一行：$R_1 + 0.1R_2 \rightarrow R_1$
      * 第三行：$R_3 + 0.8R_2 \rightarrow R_3$
      * 第四行：$R_4 - 3R_2 \rightarrow R_4$

      $$
      \begin{bmatrix}
      1 & 0 & 0.1927 & 0.0275 & | & 0.8349 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 9.5413 & -0.7798 & | & -10.3211 \\
      0 & 0 & -0.7798 & 7.1743 & | & 7.9542
      \end{bmatrix}
      $$
4. **第三步**（消去 $x_3$）：

    * 将第三行除以 9.5413：

      $$
      \begin{bmatrix}
      1 & 0 & 0.1927 & 0.0275 & | & 0.8349 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 1 & -0.0817 & | & -1.0817 \\
      0 & 0 & -0.7798 & 7.1743 & | & 7.9542
      \end{bmatrix}
      $$
    * 用第三行消去其他行的 $x_3$：

      * 第一行：$R_1 - 0.1927R_3 \rightarrow R_1$
      * 第二行：$R_2 + 0.0734R_3 \rightarrow R_2$
      * 第四行：$R_4 + 0.7798R_3 \rightarrow R_4$

      $$
      \begin{bmatrix}
      1 & 0 & 0 & 0.0333 & | & 1.0426 \\
      0 & 1 & 0 & 0.2691 & | & 2.2691 \\
      0 & 0 & 1 & -0.0817 & | & -1.0817 \\
      0 & 0 & 0 & 7.1102 & | & 7.1102
      \end{bmatrix}
      $$
5. **第四步**（消去 $x_4$）：

    * 将第四行除以 7.1102：

      $$
      \begin{bmatrix}
      1 & 0 & 0 & 0.0333 & | & 1.0426 \\
      0 & 1 & 0 & 0.2691 & | & 2.2691 \\
      0 & 0 & 1 & -0.0817 & | & -1.0817 \\
      0 & 0 & 0 & 1 & | & 1
      \end{bmatrix}
      $$
    * 用第四行消去其他行的 $x_4$：

      * 第一行：$R_1 - 0.0333R_4 \rightarrow R_1$
      * 第二行：$R_2 - 0.2691R_4 \rightarrow R_2$
      * 第三行：$R_3 + 0.0817R_4 \rightarrow R_3$

      $$
      \begin{bmatrix}
      1 & 0 & 0 & 0 & | & 1 \\
      0 & 1 & 0 & 0 & | & 2 \\
      0 & 0 & 1 & 0 & | & -1 \\
      0 & 0 & 0 & 1 & | & 1
      \end{bmatrix}
      $$

#### **结果**

约当消去法计算得到的数值解为：

$$
x = (1, 2, -1, 1)^T
$$

---

## **2. 高斯消去法**

### **计算过程**

1. **初始化**：

    * 将方程组写成增广矩阵形式：

      $$
      \begin{bmatrix}
      10 & -1 & 2 & 0 & | & 6 \\
      -1 & 11 & -1 & 3 & | & 25 \\
      2 & -1 & 10 & -1 & | & -11 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
2. **第一步**（消去 $x_1$）：

    * 将第一行除以 10：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      -1 & 11 & -1 & 3 & | & 25 \\
      2 & -1 & 10 & -1 & | & -11 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
    * 用第一行消去其他行的 $x_1$：

      * 第二行：$R_2 + R_1 \rightarrow R_2$
      * 第三行：$R_3 - 2R_1 \rightarrow R_3$
      * 第四行：$R_4$ 不变

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 10.9 & -0.8 & 3 & | & 25.6 \\
      0 & -0.8 & 9.6 & -1 & | & -12.2 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
3. **第二步**（消去 $x_2$）：

    * 将第二行除以 10.9：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & -0.8 & 9.6 & -1 & | & -12.2 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
    * 用第二行消去其他行的 $x_2$：

      * 第三行：$R_3 + 0.8R_2 \rightarrow R_3$
      * 第四行：$R_4 - 3R_2 \rightarrow R_4$

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 9.5413 & -0.7798 & | & -10.3211 \\
      0 & 0 & -0.7798 & 7.1743 & | & 7.9542
      \end{bmatrix}
      $$
4. **第三步**（消去 $x_3$）：

    * 将第三行除以 9.5413：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 1 & -0.0817 & | & -1.0817 \\
      0 & 0 & -0.7798 & 7.1743 & | & 7.9542
      \end{bmatrix}
      $$
    * 用第三行消去其他行的 $x_3$：

      * 第四行：$R_4 + 0.7798R_3 \rightarrow R_4$

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 1 & -0.0817 & | & -1.0817 \\
      0 & 0 & 0 & 7.1102 & | & 7.1102
      \end{bmatrix}
      $$
5. **回代过程**：

    * 从第四行开始回代：

      $$
      x_4 = \frac{7.1102}{7.1102} = 1
      $$

      $$
      x_3 = -1.0817 + 0.0817 \cdot 1 = -1
      $$

      $$
      x_2 = 2.3486 - 0.2752 \cdot 1 + 0.0734 \cdot (-1) = 2
      $$

      $$
      x_1 = 0.6 + 0.1 \cdot 2 - 0.2 \cdot (-1) = 1
      $$

#### **结果**

高斯消去法计算得到的数值解为：

$$
x = (1, 2, -1, 1)^T
$$

---

## **3. 高斯列主元消去法**

### **计算过程**

1. **初始化**：

    * 将方程组写成增广矩阵形式：

      $$
      \begin{bmatrix}
      10 & -1 & 2 & 0 & | & 6 \\
      -1 & 11 & -1 & 3 & | & 25 \\
      2 & -1 & 10 & -1 & | & -11 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
2. **第一步**（选主元）：

    * 第一列中绝对值最大的元素是 10，位于第一行，无需交换。
3. **第一步**（消去 $x_1$）：

    * 将第一行除以 10：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      -1 & 11 & -1 & 3 & | & 25 \\
      2 & -1 & 10 & -1 & | & -11 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
    * 用第一行消去其他行的 $x_1$：

      * 第二行：$R_2 + R_1 \rightarrow R_2$
      * 第三行：$R_3 - 2R_1 \rightarrow R_3$
      * 第四行：$R_4$ 不变

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 10.9 & -0.8 & 3 & | & 25.6 \\
      0 & -0.8 & 9.6 & -1 & | & -12.2 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
4. **第二步**（选主元）：

    * 第二列中绝对值最大的元素是 10.9，位于第二行，无需交换。
5. **第二步**（消去 $x_2$）：

    * 将第二行除以 10.9：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & -0.8 & 9.6 & -1 & | & -12.2 \\
      0 & 3 & -1 & 8 & | & 15
      \end{bmatrix}
      $$
    * 用第二行消去其他行的 $x_2$：

      * 第三行：$R_3 + 0.8R_2 \rightarrow R_3$
      * 第四行：$R_4 - 3R_2 \rightarrow R_4$

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 9.5413 & -0.7798 & | & -10.3211 \\
      0 & 0 & -0.7798 & 7.1743 & | & 7.9542
      \end{bmatrix}
      $$
6. **第三步**（选主元）：

    * 第三列中绝对值最大的元素是 9.5413，位于第三行，无需交换。
7. **第三步**（消去 $x_3$）：

    * 将第三行除以 9.5413：

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 1 & -0.0817 & | & -1.0817 \\
      0 & 0 & -0.7798 & 7.1743 & | & 7.9542
      \end{bmatrix}
      $$
    * 用第三行消去其他行的 $x_3$：

      * 第四行：$R_4 + 0.7798R_3 \rightarrow R_4$

      $$
      \begin{bmatrix}
      1 & -0.1 & 0.2 & 0 & | & 0.6 \\
      0 & 1 & -0.0734 & 0.2752 & | & 2.3486 \\
      0 & 0 & 1 & -0.0817 & | & -1.0817 \\
      0 & 0 & 0 & 7.1102 & | & 7.1102
      \end{bmatrix}
      $$
8. **回代过程**：

    * 从第四行开始回代：

      $$
      x_4 = \frac{7.1102}{7.1102} = 1
      $$

      $$
      x_3 = -1.0817 + 0.0817 \cdot 1 = -1
      $$

      $$
      x_2 = 2.3486 - 0.2752 \cdot 1 + 0.0734 \cdot (-1) = 2
      $$

      $$
      x_1 = 0.6 + 0.1 \cdot 2 - 0.2 \cdot (-1) = 1
      $$

#### **结果**

高斯列主元消去法计算得到的数值解为：

$$
x = (1, 2, -1, 1)^T
$$

---

## **1. 追赶法**

追赶法用于求解**三对角线性方程组**，即系数矩阵只有主对角线和两条相邻次对角线有非零元素的方程组。追赶法的核心思想是通过**消元**和**回代**两步求解。

### **问题描述**

求解以下三对角方程组：

$$
\begin{cases}
2x_1 - x_2 = 1 \\
-x_1 + 2x_2 - x_3 = 0 \\
-x_2 + 2x_3 - x_4 = 0 \\
-x_3 + 2x_4 = 1
\end{cases}
$$

### **追赶法的步骤**

#### **1. 追的过程（消元）**

1. **初始化**：

    * 将方程组写成矩阵形式：

      $$
      \begin{bmatrix}
      2 & -1 & 0 & 0 \\
      -1 & 2 & -1 & 0 \\
      0 & -1 & 2 & -1 \\
      0 & 0 & -1 & 2
      \end{bmatrix}
      \begin{bmatrix}
      x_1 \\
      x_2 \\
      x_3 \\
      x_4
      \end{bmatrix}
      =
      \begin{bmatrix}
      1 \\
      0 \\
      0 \\
      1
      \end{bmatrix}
      $$
2. **计算中间变量** **$u_i$** **和** **$y_i$**：

    * 定义：

      $$
      u_i = \frac{c_i}{b_i - u_{i-1} a_i}, \quad y_i = \frac{f_i - y_{i-1} a_i}{b_i - u_{i-1} a_i}
      $$

      其中 $a_i$ 是下对角线元素，$b_i$ 是主对角线元素，$c_i$ 是上对角线元素，$f_i$ 是常数项。
    * 计算：

      $$
      u_1 = \frac{-1}{2} = -0.5, \quad y_1 = \frac{1}{2} = 0.5
      $$

      $$
      u_2 = \frac{-1}{2 - (-0.5) \cdot (-1)} = \frac{-1}{1.5} \approx -0.6667, \quad y_2 = \frac{0 - (-0.5) \cdot 0.5}{1.5} \approx 0.1667
      $$

      $$
      u_3 = \frac{-1}{2 - (-0.6667) \cdot (-1)} = \frac{-1}{1.3333} \approx -0.75, \quad y_3 = \frac{0 - (-0.6667) \cdot 0.1667}{1.3333} \approx 0.0833
      $$

      $$
      y_4 = \frac{1 - (-0.75) \cdot 0.0833}{2 - (-0.75) \cdot (-1)} \approx \frac{1 + 0.0625}{1.25} \approx 0.85
      $$

#### **2. 赶的过程（回代）**

1. **回代求解**：

    * 从最后一个方程开始回代：

      $$
      x_4 = y_4 \approx 0.85
      $$

      $$
      x_3 = y_3 - u_3 x_4 \approx 0.0833 - (-0.75) \cdot 0.85 \approx 0.725
      $$

      $$
      x_2 = y_2 - u_2 x_3 \approx 0.1667 - (-0.6667) \cdot 0.725 \approx 0.65
      $$

      $$
      x_1 = y_1 - u_1 x_2 \approx 0.5 - (-0.5) \cdot 0.65 \approx 0.825
      $$

#### **结果**

追赶法计算得到的数值解为：

$$
x \approx (0.825, 0.65, 0.725, 0.85)^T
$$

---

## **2. 平方根法**

平方根法用于求解**对称正定线性方程组**，即系数矩阵是对称且正定的方程组。平方根法的核心思想是通过**Cholesky分解**将系数矩阵分解为下三角矩阵和其转置的乘积，然后通过**前代**和**回代**求解。

### **问题描述**

求解以下对称正定方程组：

$$
\begin{cases}
4x_1 + 2x_2 + 2x_3 = 8 \\
2x_1 + 5x_2 + 2x_3 = 12 \\
2x_1 + 2x_2 + 6x_3 = 14
\end{cases}
$$

### **平方根法的步骤**

#### **1. Cholesky分解**

1. **初始化**：

    * 将方程组写成矩阵形式：

      $$
      \begin{bmatrix}
      4 & 2 & 2 \\
      2 & 5 & 2 \\
      2 & 2 & 6
      \end{bmatrix}
      \begin{bmatrix}
      x_1 \\
      x_2 \\
      x_3
      \end{bmatrix}
      =
      \begin{bmatrix}
      8 \\
      12 \\
      14
      \end{bmatrix}
      $$
2. **计算下三角矩阵** **$L$**：

    * Cholesky分解公式：

      $$
      L_{ii} = \sqrt{A_{ii} - \sum_{k=1}^{i-1} L_{ik}^2}, \quad L_{ij} = \frac{A_{ij} - \sum_{k=1}^{j-1} L_{ik} L_{jk}}{L_{jj}}
      $$
    * 计算：

      $$
      L_{11} = \sqrt{4} = 2
      $$

      $$
      L_{21} = \frac{2}{2} = 1, \quad L_{22} = \sqrt{5 - 1^2} = 2
      $$

      $$
      L_{31} = \frac{2}{2} = 1, \quad L_{32} = \frac{2 - 1 \cdot 1}{2} = 0.5, \quad L_{33} = \sqrt{6 - 1^2 - 0.5^2} = 2
      $$
    * 得到：

      $$
      L = \begin{bmatrix}
      2 & 0 & 0 \\
      1 & 2 & 0 \\
      1 & 0.5 & 2
      \end{bmatrix}
      $$

#### **2. 前代求解** **$Ly = b$**

1. **计算** **$y$**：

    $$
    y_1 = \frac{8}{2} = 4
    $$

    $$
    y_2 = \frac{12 - 1 \cdot 4}{2} = 4
    $$

    $$
    y_3 = \frac{14 - 1 \cdot 4 - 0.5 \cdot 4}{2} = 4
    $$

#### **3. 回代求解** **$L^T x = y$**

1. **计算** **$x$**：

    $$
    x_3 = \frac{4}{2} = 2
    $$

    $$
    x_2 = \frac{4 - 0.5 \cdot 2}{2} = 1.5
    $$

    $$
    x_1 = \frac{4 - 1 \cdot 1.5 - 1 \cdot 2}{2} = 0.25
    $$

#### **结果**

平方根法计算得到的数值解为：

$$
x = (0.25, 1.5, 2)^T
$$

---

## **3. 改进的平方根法（Cholesky分解法）**

改进的平方根法是平方根法的优化版本，通过引入对角矩阵 $D$ 避免开方运算，从而提高计算效率。

### **问题描述**

求解以下对称正定方程组：

$$
\begin{cases}
4x_1 + 2x_2 + 2x_3 = 8 \\
2x_1 + 5x_2 + 2x_3 = 12 \\
2x_1 + 2x_2 + 6x_3 = 14
\end{cases}
$$

### **改进的平方根法的步骤**

#### **1. Cholesky分解**

1. **初始化**：

    * 将方程组写成矩阵形式：

      $$
      \begin{bmatrix}
      4 & 2 & 2 \\
      2 & 5 & 2 \\
      2 & 2 & 6
      \end{bmatrix}
      \begin{bmatrix}
      x_1 \\
      x_2 \\
      x_3
      \end{bmatrix}
      =
      \begin{bmatrix}
      8 \\
      12 \\
      14
      \end{bmatrix}
      $$
2. **计算下三角矩阵** **$L$** **和对角矩阵** **$D$**：

    * 改进的Cholesky分解公式：

      $$
      L_{ij} = \frac{A_{ij} - \sum_{k=1}^{j-1} L_{ik} D_{kk} L_{jk}}{D_{jj}}, \quad D_{ii} = A_{ii} - \sum_{k=1}^{i-1} L_{ik}^2 D_{kk}
      $$
    * 计算：

      $$
      D_{11} = 4, \quad L_{11} = 1
      $$

      $$
      L_{21} = \frac{2}{4} = 0.5, \quad D_{22} = 5 - 0.5^2 \cdot 4 = 4, \quad L_{22} = 1
      $$

      $$
      L_{31} = \frac{2}{4} = 0.5, \quad L_{32} = \frac{2 - 0.5 \cdot 4 \cdot 0.5}{4} = 0.25, \quad D_{33} = 6 - 0.5^2 \cdot 4 - 0.25^2 \cdot 4 = 4, \quad L_{33} = 1
      $$
    * 得到：

      $$
      L = \begin{bmatrix}
      1 & 0 & 0 \\
      0.5 & 1 & 0 \\
      0.5 & 0.25 & 1
      \end{bmatrix}, \quad
      D = \begin{bmatrix}
      4 & 0 & 0 \\
      0 & 4 & 0 \\
      0 & 0 & 4
      \end{bmatrix}
      $$

#### **2. 前代求解** **$Ly = b$**

1. **计算** **$y$**：

    $$
    y_1 = \frac{8}{1} = 8
    $$

    $$
    y_2 = \frac{12 - 0.5 \cdot 8}{1} = 8
    $$

    $$
    y_3 = \frac{14 - 0.5 \cdot 8 - 0.25 \cdot 8}{1} = 8
    $$

#### **3. 回代求解** **$L^T x = D^{-1} y$**

1. **计算** **$x$**：

    $$
    x_3 = \frac{8}{4} = 2
    $$

    $$
    x_2 = \frac{8 - 0.25 \cdot 2}{4} = 1.875
    $$

    $$
    x_1 = \frac{8 - 0.5 \cdot 1.875 - 0.5 \cdot 2}{4} = 1.53125
    $$

#### **结果**

改进的平方根法计算得到的数值解为：

$$
x = (1.53125, 1.875, 2)^T
$$
