# 插值例子

### 1. **拉格朗日插值**

#### 问题描述

已知函数 $f(x)$ 在三个点 $x_0 = 1$, $x_1 = 2$, $x_2 = 3$ 处的函数值分别为 $y_0 = 1$, $y_1 = 4$, $y_2 = 9$。求 $f(x)$ 的拉格朗日插值多项式，并计算 $f(2.5)$ 的近似值。

#### 解决方法

拉格朗日插值多项式为：

$$
P_n(x) = \sum_{k=0}^{n} y_k \cdot l_k(x)
$$

其中，$l_k(x)$ 是拉格朗日基函数：

$$
l_k(x) = \prod_{\substack{j=0 \\ j \neq k}}^{n} \frac{x - x_j}{x_k - x_j}
$$

#### 计算过程

1. **计算基函数** **$l_k(x)$**​ **：**

    * 对于 $k = 0$：

      $$
      l_0(x) = \frac{(x - 2)(x - 3)}{(1 - 2)(1 - 3)} = \frac{(x - 2)(x - 3)}{2}
      $$
    * 对于 $k = 1$：

      $$
      l_1(x) = \frac{(x - 1)(x - 3)}{(2 - 1)(2 - 3)} = \frac{(x - 1)(x - 3)}{-1}
      $$
    * 对于 $k = 2$：

      $$
      l_2(x) = \frac{(x - 1)(x - 2)}{(3 - 1)(3 - 2)} = \frac{(x - 1)(x - 2)}{2}
      $$
2. **构造拉格朗日插值多项式：**

    $$
    P_2(x) = 1 \cdot \frac{(x - 2)(x - 3)}{2} + 4 \cdot \frac{(x - 1)(x - 3)}{-1} + 9 \cdot \frac{(x - 1)(x - 2)}{2}
    $$
3. **计算** **$f(2.5)$** **的近似值：**   
    将 $x = 2.5$ 代入 $P_2(x)$：

    $$
    P_2(2.5) = 1 \cdot \frac{(2.5 - 2)(2.5 - 3)}{2} + 4 \cdot \frac{(2.5 - 1)(2.5 - 3)}{-1} + 9 \cdot \frac{(2.5 - 1)(2.5 - 2)}{2}
    $$

    计算每一项：

    $$
    P_2(2.5) = 1 \cdot \frac{(0.5)(-0.5)}{2} + 4 \cdot \frac{(1.5)(-0.5)}{-1} + 9 \cdot \frac{(1.5)(0.5)}{2}
    $$

    $$
    P_2(2.5) = -0.125 + 3 + 3.375 = 6.25
    $$

    因此，$f(2.5) \approx 6.25$。

---

### 2. **牛顿插值**

#### 问题描述

已知函数 $f(x)$ 在三个点 $x_0 = 1$, $x_1 = 2$, $x_2 = 3$ 处的函数值分别为 $y_0 = 1$, $y_1 = 4$, $y_2 = 9$。求 $f(x)$ 的牛顿插值多项式，并计算 $f(2.5)$ 的近似值。

#### 解决方法

牛顿插值多项式为：

$$
P_n(x) = f(x_0) + f[x_0, x_1](x - x_0) + f[x_0, x_1, x_2](x - x_0)(x - x_1) + \cdots
$$

其中，$f[x_0, x_1]$ 和 $f[x_0, x_1, x_2]$ 是差商。

#### 计算过程

1. **计算差商：**

    * 一阶差商：

      $$
      f[x_0, x_1] = \frac{f(x_1) - f(x_0)}{x_1 - x_0} = \frac{4 - 1}{2 - 1} = 3
      $$

      $$
      f[x_1, x_2] = \frac{f(x_2) - f(x_1)}{x_2 - x_1} = \frac{9 - 4}{3 - 2} = 5
      $$
    * 二阶差商：

      $$
      f[x_0, x_1, x_2] = \frac{f[x_1, x_2] - f[x_0, x_1]}{x_2 - x_0} = \frac{5 - 3}{3 - 1} = 1
      $$
2. **构造牛顿插值多项式：**

    $$
    P_2(x) = 1 + 3(x - 1) + 1(x - 1)(x - 2)
    $$
3. **计算** **$f(2.5)$** **的近似值：**   
    将 $x = 2.5$ 代入 $P_2(x)$：

    $$
    P_2(2.5) = 1 + 3(2.5 - 1) + 1(2.5 - 1)(2.5 - 2)
    $$

    $$
    P_2(2.5) = 1 + 3(1.5) + 1(1.5)(0.5)
    $$

    $$
    P_2(2.5) = 1 + 4.5 + 0.75 = 6.25
    $$

    因此，$f(2.5) \approx 6.25$。

---

### 3. **分段线性插值**

#### 问题描述

已知函数 $f(x)$ 在三个点 $x_0 = 1$, $x_1 = 2$, $x_2 = 3$ 处的函数值分别为 $y_0 = 1$, $y_1 = 4$, $y_2 = 9$。求 $f(x)$ 的分段线性插值函数，并计算 $f(2.5)$ 的近似值。

#### 解决方法

分段线性插值是在每个小区间 $[x_i, x_{i+1}]$ 上用线性函数连接两个点。

#### 计算过程

1. **确定插值区间：**

    * $x = 2.5$ 落在区间 $[2, 3]$ 上。
2. **构造线性插值函数：**   
    在区间 $[2, 3]$ 上，线性插值函数为：

    $$
    S(x) = y_1 + \frac{y_2 - y_1}{x_2 - x_1}(x - x_1)
    $$

    代入 $y_1 = 4$, $y_2 = 9$, $x_1 = 2$, $x_2 = 3$：

    $$
    S(x) = 4 + \frac{9 - 4}{3 - 2}(x - 2) = 4 + 5(x - 2)
    $$
3. **计算** **$f(2.5)$** **的近似值：**   
    将 $x = 2.5$ 代入 $S(x)$：

    $$
    S(2.5) = 4 + 5(2.5 - 2) = 4 + 5(0.5) = 6.5
    $$

    因此，$f(2.5) \approx 6.5$。

---

### 4. **完全导数 Hermite 插值**

#### 问题描述

已知函数 $f(x)$ 在 $x_0 = 1$ 和 $x_1 = 2$ 处的函数值和导数值分别为：

* $f(1) = 1$, $f'(1) = 2$
* $f(2) = 4$, $f'(2) = 3$

求 $f(x)$ 的 Hermite 插值多项式，并计算 $f(1.5)$ 的近似值。

#### 解决方法

Hermite 插值多项式为：

$$
H_3(x) = f(x_0) + f'(x_0)(x - x_0) + f[x_0, x_1](x - x_0)^2 + f[x_0, x_1, x_1](x - x_0)^2(x - x_1)
$$

#### 计算过程

1. **计算差商：**

    * 一阶差商：

      $$
      f[x_0, x_1] = \frac{f(x_1) - f(x_0)}{x_1 - x_0} = \frac{4 - 1}{2 - 1} = 3
      $$
    * 二阶差商：

      $$
      f[x_0, x_1, x_1] = \frac{f'(x_1) - f[x_0, x_1]}{x_1 - x_0} = \frac{3 - 3}{2 - 1} = 0
      $$
2. **构造 Hermite 插值多项式：**

    $$
    H_3(x) = 1 + 2(x - 1) + 3(x - 1)^2 + 0(x - 1)^2(x - 2)
    $$

    化简：

    $$
    H_3(x) = 1 + 2(x - 1) + 3(x - 1)^2
    $$
3. **计算** **$f(1.5)$** **的近似值：**   
    将 $x = 1.5$ 代入 $H_3(x)$：

    $$
    H_3(1.5) = 1 + 2(1.5 - 1) + 3(1.5 - 1)^2
    $$

    $$
    H_3(1.5) = 1 + 2(0.5) + 3(0.25) = 1 + 1 + 0.75 = 2.75
    $$

    因此，$f(1.5) \approx 2.75$。

---

### 5. **不完全导数 Hermite 插值**

#### 问题描述

已知函数 $f(x)$ 在 $x_0 = 1$ 和 $x_1 = 2$ 处的函数值和导数值分别为：

* $f(1) = 1$, $f'(1) = 2$
* $f(2) = 4$, $f'(2)$ 未知

求 $f(x)$ 的 Hermite 插值多项式，并计算 $f(1.5)$ 的近似值。

#### 解决方法

由于 $f'(2)$ 未知，我们只能使用部分导数值进行插值。

#### 计算过程

1. **构造 Hermite 插值多项式：**

    $$
    H_2(x) = f(x_0) + f'(x_0)(x - x_0) + f[x_0, x_1](x - x_0)^2
    $$

    代入已知值：

    $$
    H_2(x) = 1 + 2(x - 1) + 3(x - 1)^2
    $$
2. **计算** **$f(1.5)$** **的近似值：**   
    将 $x = 1.5$ 代入 $H_2(x)$：

    $$
    H_2(1.5) = 1 + 2(0.5) + 3(0.25) = 1 + 1 + 0.75 = 2.75
    $$

    因此，$f(1.5) \approx 2.75$。

---

### 6. **样条插值**

#### 问题描述

已知函数 $f(x)$ 在三个点 $x_0 = 1$, $x_1 = 2$, $x_2 = 3$ 处的函数值分别为 $y_0 = 1$, $y_1 = 4$, $y_2 = 9$。求 $f(x)$ 的三次样条插值函数，并计算 $f(2.5)$ 的近似值。

#### 解决方法

三次样条插值需要满足插值条件和光滑性条件（一阶和二阶导数连续）。

#### 计算过程

1. **构造三次样条插值函数：**   
    由于计算复杂，通常使用数值方法或软件工具（如 MATLAB）进行计算。假设通过计算得到样条函数为：

    $$
    S(x) = 
    \begin{cases}
    S_0(x) = a_0 + b_0(x - 1) + c_0(x - 1)^2 + d_0(x - 1)^3, & 1 \leq x \leq 2 \\
    S_1(x) = a_1 + b_1(x - 2) + c_1(x - 2)^2 + d_1(x - 2)^3, & 2 \leq x \leq 3
    \end{cases}
    $$
2. **计算** **$f(2.5)$** **的近似值：**   
    假设通过计算得到 $S_1(2.5) = 6.25$，因此 $f(2.5) \approx 6.25$。

---

### 7. **曲线拟合的最小二乘法**

#### 问题描述

已知数据点 $(x_i, y_i)$ 如下：

* $(1, 1)$
* $(2, 4)$
* $(3, 9)$

用最小二乘法拟合一条直线 $y = a + bx$。

#### 解决方法

最小二乘法的目标是使残差平方和最小：

$$
Q = \sum_{i=1}^{n} (y_i - (a + b x_i))^2
$$

#### 计算过程

1. **构造正规方程组：**

    $$
    \begin{cases}
    n a + b \sum x_i = \sum y_i \\
    a \sum x_i + b \sum x_i^2 = \sum x_i y_i
    \end{cases}
    $$

    代入数据：

    $$
    \begin{cases}
    3a + 6b = 14 \\
    6a + 14b = 36
    \end{cases}
    $$
2. **解方程组：**   
    解得 $a = -1$, $b = 3$。
3. **拟合直线：**

    $$
    y = -1 + 3x
    $$
4. **计算拟合值：**   
    对于 $x = 2.5$：

    $$
    y = -1 + 3(2.5) = 6.5
    $$

    因此，$f(2.5) \approx 6.5$。

---

### 总结

* **拉格朗日插值** 和 **牛顿插值** 都给出了 $f(2.5) \approx 6.25$。
* **分段线性插值** 和 **最小二乘法** 给出了 $f(2.5) \approx 6.5$。
* **Hermite 插值** 和 **样条插值** 的结果依赖于具体条件。

这些方法各有优缺点，适用于不同的应用场景。
