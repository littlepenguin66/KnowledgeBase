# 地球物理计算方法第6章线性方程组直接法

[线性方程组直接法求解](线性方程组直接法求解.md)

### 消去法

1. **约当消去法**

    * **基本原理与步骤**：约当消去法的核心特点是在每一步操作中，仅在一个方程里保留某个特定变元，同时从其他各个方程中消除该变元。通过这样反复的消元过程，最终将所给方程组中的每个方程都转化为仅含一个变元的形式，从而直接得出方程组的解。

      * 对于一般形式的方程组$Ax = b$，其中$A=\begin{bmatrix}a_{11}&a_{12}&\cdots&a_{1n}\\a_{21}&a_{22}&\cdots&a_{2n}\\\vdots&\vdots&\vdots&\vdots\\a_{n1}&a_{n2}&\cdots&a_{nn}\end{bmatrix}$，$x=\begin{bmatrix}x_{1}\\x_{2}\\\vdots\\x_{n}\end{bmatrix}$，$b=\begin{bmatrix}b_{1}\\b_{2}\\\vdots\\b_{n}\end{bmatrix}$。
      * 第一步，将方程$Ax = b$中$x_{1}$的系数化为$1$，并从其余方程中消去$x_{1}$，得到$\begin{cases}x_{1}+\sum_{j = 2}^{n}a_{1j}^{(1)}x_{j}=b_{1}^{(1)}\\\sum_{j = 2}^{n}a_{ij}^{(1)}x_{j}=b_{i}^{(1)},i = 2,3,\cdots,n\end{cases}$。
      * 第二步，将方程中$x_{2}$的系数化为$1$，并从方程组的其余方程中消去$x_{2}$，此时方程组变为$\begin{cases}x_{i}+\sum_{j = k}^{n}a_{ij}^{(k - 1)}x_{j}=b_{i}^{(k - 1)},i = 1,2,\cdots,k - 1\\\sum_{j = k}^{n}a_{ij}^{(k - 1)}x_{j}=b_{i}^{(k - 1)},i = k,k + 1,\cdots,n\end{cases}$（这里$k = 2$）。接着，将$x_{k}$（此时$k = 2$）的系数化为$1$，然后从其余各个方程中消去$x_{k}$，得到新的方程组形式。
      * 以此类推，经过$n$步后，将$x_{n}$的系数化为$1$，就可以得到方程组的解$\begin{cases}x_{1}=b_{1}^{(n)}\\\vdots\\x_{i}=b_{i}^{(n)}\\\vdots\\x_{n}=b_{n}^{(n)}\end{cases}$。
    * **计算量分析**：在由方程组$Ax = b$化为上述每一步的新方程组时，涉及到一定的计算量。例如，由方程组$(9)$化为方程组$(10)$需要经过特定公式的运算，其中公式$(11)$的计算量为$n - k + 1$，公式$(12)$的计算量为$(n - k + 1)(n - 1)$。由此可计算出第$k$步的计算量为$(n - k + 1)n$，那么第$1$至$n$步的总计算量约为$\sum_{k = 1}^{n}(n - k + 1)n\approx\frac{n^{3}}{2}$。
    * **算法流程**：约当消元法的算法流程包括读入数据，然后按照特定公式进行系数的变换，将主元系数化为$1$并消去其他方程中的该变元，在每一步操作中，根据公式计算新的系数和常数项，不断重复这个过程，直到完成$n$步操作，最后输出方程组的解$b_{1},b_{2},\cdots,b_{n}$。
2. **高斯消去法**

    * **与约当消去法的关系及改进之处**：高斯消去法是对约当消去法的一种改进。它的求解过程分为消元过程和回代过程两个环节。消元过程将所给的方程组逐步加工成上三角方程组，然后再通过回代过程得出方程组的解。相比约当消去法，高斯消去法虽然算法结构稍复杂一些，但是它显著减少了计算量。
    * **求解过程**：

      * 对于方程组$Ax = b$，同样先考虑消元过程。第一步，将方程中$x_{1}$的系数化为$1$，并从其余方程中消去$x_{1}$，得到$\begin{cases}x_{1}+\sum_{j = 2}^{n}a_{1j}^{(1)}x_{j}=b_{1}^{(1)}\\\sum_{j = 2}^{n}a_{ij}^{(1)}x_{j}=b_{i}^{(1)},i = 2,3,\cdots,n\end{cases}$。
      * 第二步，将方程中$x_{2}$的系数化为$1$，并从方程$3$到$n$中消去$x_{2}$，得到$\begin{cases}x_{2}+\sum_{j = 3}^{n}a_{2j}^{(2)}x_{j}=b_{2}^{(2)}\\\sum_{j = 3}^{n}a_{ij}^{(2)}x_{j}=b_{i}^{(2)},i = 3,4,\cdots,n\end{cases}$。继续这个过程，经过$k - 1$步消元后，得到由$k - 1$个系数为$1$的方程和变元$x_{j}(j = k,k + 1,\cdots,n)$组成的方程组。第$k$步对$x_{k}$的系数化为$1$，得到$\begin{cases}x_{k}+\sum_{j = k + 1}^{n}a_{k j}^{(k)}x_{j}=b_{k}^{(k)}\\\sum_{j = k + 1}^{n}a_{i j}^{(k)}x_{j}=b_{i}^{(k)},i = k + 1,k + 2,\cdots,n\end{cases}$，最终得到上三角方程组$x_{i}+\sum_{j = i + 1}^{n}a_{i j}^{(i)}x_{j}=b_{i}^{(i)},i = 1,2,\cdots,n$。
      * 接着是回代过程，对方程组自下而上逐步回代求解。即$x_{i}=b_{i}^{(i)}-\sum_{j = i + 1}^{n}a_{i j}^{(i)}x_{j},i = n,n - 1,\cdots,1$。
    * **高斯消去法能顺利实施的条件**：

      * 计算第$k$步时要满足$a_{kk}^{(k - 1)}\neq0$（$k = 1,2,\cdots,n$）。这是因为在消元过程中，需要用$a_{kk}^{(k - 1)}$作为除数来将$x_{k}$的系数化为$1$，如果$a_{kk}^{(k - 1)} = 0$，则无法进行正常的消元操作。
      * 其充要条件是系数矩阵$A$的前$n - 1$阶顺序主子式$\Delta_{k}\neq0$。这个条件从矩阵的行列式性质角度保证了高斯消去法能够顺利进行。
    * **算法流程**：高斯消去法的算法流程首先读入数据，然后进行选主元素操作（在某些情况下需要保证计算的稳定性），接着按照公式将主元系数化为$1$并消去其他方程中的该变元，完成消元过程后，进行回代操作，根据回代公式计算出方程组的解，最后输出结果。
3. **高斯列主元消去法**

    * **引入原因**：通过一个具体例子可以看出引入高斯列主元消去法的必要性。例如对于方程组$\begin{cases}10^{-5}x_{1}+x_{2}=1\\x_{1}+x_{2}=2\end{cases}$，若直接使用高斯消去法求解，首先将第一个方程中$x_{1}$的系数化为$1$，然后从第二个方程消去$x_{1}$，得到$\begin{cases}x_{1}+10^{5}x_{2}=10^{5}\$1 - 10^{5})x_{2}=2 - 10^{5}\end{cases}$。若取四位浮点十进制进行计算（科学计数法，保留四位有效数字），则$1 - 10^{5}\approx - 10^{5}$，$2 - 10^{5}\approx - 10^{5}$，于是化简后的方程组为$\begin{cases}x_{1}+10^{5}x_{2}=10^{5}\\x_{2}=1\end{cases}$，解得$\begin{cases}x_{1}=0\\x_{2}=1\end{cases}$，这个解与实际解相差很大，出现了解失真的情况。解失真的根源在于$x_{1}$的系数太小，使得在将方程中$x_{2}$的系数化为$1$的过程中出现了计算机舍入误差。
    * **方法步骤**：为了解决上述问题，高斯列主元消去法在消元之前先调整方程的次序。具体做法是从方程组中各个$x_{k}$系数$a_{kk}^{(k - 1)},a_{k + 1,k}^{(k - 1)},\cdots,a_{n,k}^{(k - 1)}$中按绝对值最大挑选出最大值，称之为第$k$步的主元素。假设主元素在第$l(k\leq l\leq n)$个方程，即$|a_{lk}^{(k - 1)}|=\max_{k\leq i\leq n}|a_{ik}^{(k - 1)}|$，若$l\neq k$，则将第$l$个方程与第$k$个方程互换位置，使得新的$a_{kk}^{(k - 1)}$成为主元素，然后再进行消元操作。
    * **定理相关**：定理2表明，设所给方程组对称且是对角占优矩阵，则$a_{kk}^{(k - 1)}(k = 1,2,\cdots,n)$全是主元素。这为在特定条件下判断主元素提供了理论依据。
    * **算法流程**：高斯列主元消去法的算法流程在高斯消去法流程的基础上增加了选主元的过程。首先读入数据，然后开始选主元，判断主元是否为$0$，若为$0$则输出奇异标志，表示方程组可能无解或有无穷多解；若主元不为$0$，则进行方程互换位置操作，接着按照高斯消去法的步骤进行消元、回代等操作，最终输出方程组的解。

### 追赶法

1. **三对角方程组**

    * **定义与形式**：考虑形如$\begin{cases}b_{1}x_{1}+c_{1}x_{2}=f_{1}\\a_{2}x_{1}+b_{2}x_{2}+c_{2}x_{3}=f_{2}\\\cdots\cdots\cdots\\a_{n - 1}x_{n - 2}+b_{n - 1}x_{n - 1}+c_{n - 1}x_{n}=f_{n - 1}\\a_{n}x_{n - 1}+b_{n}x_{n}=f_{n}\end{cases}$的方程组，用矩阵形式可表示为$Ax = f$，其中$A=\begin{bmatrix}b_{1}&c_{1}& &0\\a_{2}&b_{2}&c_{2}&\\& \ddots&\ddots&\\&a_{n - 1}&b_{n - 1}&c_{n - 1}\\0& &a_{n}&b_{n}\end{bmatrix}$。这种矩阵$A$称为三对角矩阵，其特点是非零元素集中分布在主对角线及其相邻两条次对角线上。
    * **定理3及解的唯一性**：定理3指出，假设矩阵$A$为对角占优矩阵，即满足$\begin{cases}|b_{1}| > |c_{1}|\\|b_{i}| > |a_{i}| + |c_{i}|,i = 2,3,\cdots,n - 1\\|b_{n}| > |a_{n}|\end{cases}$，则它是非奇异的，此时方程组$Ax = f$有唯一解。该定理为判断三对角方程组是否有唯一解提供了重要依据，在实际应用中，当我们遇到三对角方程组时，可以首先判断其系数矩阵是否对角占优，从而确定是否可以使用追赶法等方法进行求解。
2. **追赶法的计算公式**

    * **消元过程（追的过程）** ：先用高斯消元法求解三对角方程组。第一步消元操作得到$\begin{cases}x_{1}+u_{1}x_{2}=y_{1}\\x_{2}+u_{2}x_{3}=y_{2}\\\cdots\cdots\cdots\\x_{n - 1}+u_{n - 1}x_{n}=y_{n - 1}\\x_{n}=y_{n}\end{cases}$，其中系数$u_{1}=\frac{c_{1}}{b_{1}},y_{1}=\frac{f_{1}}{b_{1}},y_{i}=\frac{c_{i}}{b_{i}-u_{i - 1}a_{i}},i = 2,3,\cdots,n - 1,y_{i}=\frac{f_{i}-y_{i - 1}a_{i}}{b_{i}-u_{i - 1}a_{i}},i = 2,3,\cdots,n$。在这个过程中，我们按照一定顺序依次计算出$u_{1},y_{1},u_{2},y_{2},\cdots,u_{n - 1},y_{n}$等系数和常数项，这就是所谓的“追”的过程，它是逐步向前计算的过程，为后续回代求解做准备。
    * **回代过程（赶的过程）** ：在完成消元过程后，进行回代操作，即$\begin{cases}x_{n}=y_{n}\\x_{i}=y_{i}-u_{i}x_{i + 1},i = n - 1,n - 2,\cdots,1\end{cases}$。从最后一个方程$x_{n}=y_{n}$开始，逐步向前回代计算出$x_{n - 1},x_{n - 2},\cdots,x_{1}$的值，这就是“赶”的过程。通过这种先消元后回代的方式，追赶法能够高效地求解三对角方程组。
    * **计算量优势**：追赶法和高斯消元法原理相同，但追赶法计算量小，这是因为方程组系数中有很多零元素。在计算过程中，由于零元素的存在，很多乘法和加法运算可以省略，从而大大减少了计算量，提高了计算效率。特别是对于大规模的三对角方程组，这种计算量的优势更加明显，使得追赶法在实际应用中成为求解三对角方程组的一种有效方法。
3. **追赶法的代数基础**

    * **矩阵分解（**​**$LU$**​**分解）** ：若三对角系数矩阵$A$对角占优，则它可以唯一地分解成矩阵$L$和$U$的乘积，即$A = LU$，其中$U$为单位上二对角矩阵，$L$为下二对角矩阵。具体表示为$L=\begin{bmatrix}d_{1}& & & &0\\a_{2}&d_{2}& & &\\& \ddots&\ddots& &\\& &a_{n - 1}&d_{n - 1}&\\0& & &a_{n}&d_{n}\end{bmatrix}$，$U=\begin{bmatrix}1&u_{1}& & &0\\&1&u_{2}& &\\& & \ddots&\ddots&\\& & &1&u_{n - 1}\\0& & & &1\end{bmatrix}$。并且$d_{1}=b_{1},u_{i}=\frac{c_{i}}{d_{i}},i = 1,2,\cdots,n - 1,d_{i + 1}=b_{i + 1}-u_{i}a_{i + 1},i = 1,2,\cdots,n - 1$。这种分解形式为追赶法提供了坚实的代数理论基础，使得我们可以从矩阵分解的角度理解和推导追赶法的计算公式。
    * **利用**​**$LU$**​**分解求解方程组**：令$A = LU$，方程组$Ax = f$可分解为$\begin{cases}Ly = f\\Ux = y\end{cases}$。解$Ly = f$可得$\begin{cases}y_{1}=\frac{f_{1}}{d_{1}}\\y_{i}=\frac{f_{i}-a_{i}y_{i - 1}}{d_{i}},i = 2,3,\cdots,n\end{cases}$；解$Ux = y$可得$x_{i}$（按照回代公式计算）。通过这种分解和分步求解的方式，我们将原三对角方程组的求解转化为两个相对简单的方程组的求解，进一步体现了追赶法的高效性和合理性。这种方法在实际计算中可以更方便地进行编程实现，并且能够利用矩阵的特殊结构来优化计算过程，提高计算速度和精度。

### 平方根法

1. **对称正定矩阵的**​**$LL^{T}$**​**分解**

    * **定理6及分解形式**：若$A$为$n$阶对称正定矩阵，则存在三角阵$L$使得$A = L\cdot L^{T}$成立。若限定$L$的主对角线元素取正值，这种分解是唯一的。这为平方根法提供了理论基础，使得我们能够将对称正定矩阵分解为特定形式，从而为求解相应的线性方程组提供了便利。
    * **元素计算公式推导**：将矩阵关系式$A = LL^{T}$直接展开，得到$\begin{cases}a_{11}=l_{11}^{2}\\a_{21}=l_{21}l_{11},a_{22}=l_{21}^{2}+l_{22}^{2}\\a_{31}=l_{31}l_{11},a_{32}=l_{31}l_{21}+l_{32}l_{22},a_{33}=l_{31}^{2}+l_{32}^{2}+l_{33}^{2}\\\cdots\end{cases}$。由此可以逐行求出矩阵$L$的元素，计算公式为$\begin{cases}l_{ij}=\frac{a_{ij}-\sum_{k = 1}^{j - 1}l_{ik}l_{jk}}{l_{jj}},j = 1,2,\cdots,i - 1\\l_{ii}=\sqrt{a_{ii}-\sum_{k = 1}^{i - 1}l_{ik}^{2}},i = 1,2,\cdots,n\end{cases}$。在计算过程中，先根据$a_{11}=l_{11}^{2}$求出$l_{11}$，然后依次计算其他元素。例如，计算$l_{21}=\frac{a_{21}}{l_{11}}$，再计算$l_{22}=\sqrt{a_{22}-l_{21}^{2}}$等，按照这样的顺序逐行计算出矩阵$L$的所有元素。
2. **平方根法求解对称正定方程组**​**$Ax = b$**

    * **分解与求解步骤**：设对称正定矩阵$A$分解为$A = LL^{T}$，则方程组$Ax = b$可归结为两个方程组来求解，即$\begin{cases}Ly = b\\L^{T}x = y\end{cases}$。

      * 对于$Ly = b$，可按顺序计算出$y_{1},y_{2},\cdots,y_{n}$，计算公式为$y_{i}=\frac{b_{i}-\sum_{k = 1}^{i - 1}l_{ik}y_{k}}{l_{ii}},i = 1,2,\cdots,n$。从$y_{1}=\frac{b_{1}}{l_{11}}$开始，逐步计算出后续的$y_{i}$值，计算过程中利用已经计算出的$y_{k}(k < i)$和矩阵$L$的元素$l_{ik}$。
      * 对于$L^{T}x = y$，可通过逆序求得$x_{n},x_{n - 1},\cdots,x_{1}$，计算公式为$x_{i}=\frac{y_{i}-\sum_{k = i + 1}^{n}l_{ki}x_{k}}{l_{ii}},i = n,n - 1,\cdots,1$。从$x_{n}=\frac{y_{n}}{l_{nn}}$开始，逐步回代计算出前面的$x_{i}$值，计算过程中利用已经计算出的$x_{k}(k > i)$和矩阵$L$的转置元素$l_{ki}$。
    * **算法名称由来**：该算法因在计算过程中含有开平方算法（如计算$l_{ii}=\sqrt{a_{ii}-\sum_{k = 1}^{i - 1}l_{ik}^{2}}$），所以称为平方根法。这种方法利用了对称正定矩阵的特殊性质，通过特定的分解和求解步骤，能够有效地求解对称正定方程组。在实际应用中，对于满足对称正定条件的方程组，平方根法是一种常用的求解方法，它具有较高的计算效率和数值稳定性。
3. **改进的平方根法（乔里斯基分解法，Cholesky）**

    * **分解形式与元素计算**：对称正定矩阵$A$可分解成$A = LDL^{T}$的形式，其中$D=\begin{bmatrix}d_{1}& & &0\\&d_{2}& &\\& & \ddots&\\0& & &d_{n}\end{bmatrix}$为对角阵，$L=\begin{bmatrix}1& & & &0\\l_{21}&1& & &\\l_{31}&l_{32}&1& &\\\vdots&\vdots&\ddots&\ddots&\\l_{n1}&l_{n2}&\cdots&l_{n,n - 1}&1\end{bmatrix}$是单位下三角阵。其元素计算公式为$\begin{cases}l_{ij}=\frac{a_{ij}-\sum_{k = 1}^{j - 1}d_{k}l_{ik}l_{jk}}{d_{j}},j = 1,2,\cdots,i - 1\\d_{i}=a_{ii}-\sum_{k = 1}^{i - 1}d_{k}l_{ik}^{2},i = 1,2,\cdots,n\end{cases}$。计算时，按照一定顺序逐行求出矩阵$L$和$D$的元素，例如先计算$d_{1}=a_{11}$，然后计算$l_{21}=\frac{a_{21}}{d_{1}}$等，依次类推。
    * **求解方程组步骤**：令$A = LDL^{T}$，方程组$Ax = b$可重新写为$L(DL^{T}x)=b$，归结为求解$\begin{cases}Ly = b\\L^{T}x = D^{-1}y\end{cases}$。其计算公式分别为$y_{i}=b_{i}-\sum_{k = 1}^{i - 1}l_{ik}y_{k},i = 1,2,\cdots,n$和$x_{i}=\frac{y_{i}}{d_{i}}-\sum_{k = i + 1}^{n}l_{ki}x_{k},i = n,n - 1,\cdots,1$。先通过$Ly = b$计算出$y$的值，然后再通过$L^{T}x = D^{-1}y$计算出$x$的值，从而得到方程组$Ax = b$的解。这种改进的方法的优点是不用进行开方运算，在一定程度上提高了计算效率，尤其在大规模计算中，减少开方运算可以节省计算时间和资源，同时也能保持较好的数值稳定性，适用于求解对称正定的线性方程组。

### 误差分析

1. **病态方程组的概念引入**

    * 通过具体例子说明病态方程组的现象。例如对于方程组$\begin{bmatrix}1&1\\1&1.0001\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}=\begin{bmatrix}2\\2.0001\end{bmatrix}$，其精确解为$x_{1}=1$，$x_{2}=1$。但当右端项存在微小扰动误差，变为$\begin{bmatrix}1&1\\1&1.0001\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}=\begin{bmatrix}2\\2\end{bmatrix}$时，解得$x_{1}=2$，$x_{2}=0$。可以发现尽管右端项仅有微小的扰动，但其解却发生了很大的变化。
    * 再看另一个例子，对于方程组$\begin{bmatrix}5&2\\4.999&2\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}=\begin{bmatrix}7\\7.002\end{bmatrix}$，解得$x_{1}=1$，$x_{2}=1$。当对系数矩阵和右端项添加微小扰动误差，变为$\begin{bmatrix}5&2\\5.001&2\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}=\begin{bmatrix}7\\7.001\end{bmatrix}$时，解得$x_{1}=2$，$x_{2}=8.5$。这表明当系数矩阵和右端项有微小扰动时，解也会发生较大变化。
    * 从几何角度解释，病态方程组的解为两条接近平行直线的交点，当其中一条直线的斜率稍微有变化时，新的交点和原交点相差比较远。基于这些现象，我们定义解对系数矩阵和右端项的扰动比较敏感的方程组为病态方程组。
2. **误差分析过程**

    * **右端项**​**$b$**​**扰动对解的影响**：设$\delta b$表示右端$b$的扰动，相应地解$x$产生的扰动为$\delta x$，则有$A(x+\delta x)=b+\delta b$。消去$Ax = b$可得$A\delta x=\delta b$，由矩阵范数的定义可得$\|\delta x\|=\|A^{-1}\delta b\|\leq\|A^{-1}\|\|\delta b\|$。另一方面，$\|x\|\geq\frac{\|Ax\|}{\|A\|}=\frac{\|b\|}{\|A\|}$，于是有$\frac{\|\delta x\|}{\|x\|}\leq\|A\|\|A^{-1}\|\frac{\|\delta b\|}{\|b\|}$。记$cond(A)=\|A^{-1}\|\|A\|$为矩阵$A$的条件数，此式表明右端项$b$的扰动对解的影响与条件数$cond(A)$的大小有关，$cond(A)$越大，扰动对解的影响就越大。
    * **系数矩阵**​**$A$**​**扰动对解的影响**：令$\delta A$表示$A$的扰动，相应的解$x$的扰动仍记为$\delta x$，则$(A+\delta A)(x+\delta x)=b$。消去$Ax = b$可得$A\delta x+\delta A(x+\delta x)=0$，故有$\|\delta x\|=\|A^{-1}\delta A(x+\delta x)\|\leq\|A^{-1}\|\|\delta A\|(\|x\|+\|\delta x\|)$。若$\delta A$足够小，使得$\|A^{-1}\|\|\delta A\|\lt1$，则有$\frac{\|\delta x\|}{\|x\|}\leq\frac{\|A^{-1}\|\|\delta A\|}{1-\|A^{-1}\|\|\delta A\|}$。同样，这里也体现了系数矩阵$A$的扰动对解的影响与条件数$cond(A)$密切相关，条件数越大，系数矩阵的微小扰动可能导致解的较大变化。
3. **定理8及相关结论**

    * 定理8表明，设$\tilde{x}$是方程组$Ax = b$的一个近似解，其精确解为$x^{*}$，$r = b - A\tilde{x}$为余量，则有$\frac{\|x^{*}-\tilde{x}\|}{\|x^{*}\|}\leq cond(A)\frac{\|r\|}{\|b\|}$。证明过程如下：由于$Ax^{*}=b$，$A(x^{*}-\tilde{x})=r$，故有$\|b\|=\|Ax^{*}\|\leq\|A\|\|x^{*}\|$，$\|x^{*}-\tilde{x}\|=\|A^{-1}r\|\leq\|A^{-1}\|\|r\|$。所以$cond(A)\frac{\|r\|}{\|b\|}=\frac{\|A\|\|A^{-1}\|\|r\|}{\|b\|}\geq\frac{\|A\|\|A^{-1}r\|}{\|b\|}\geq\frac{\|A\|\|x^{*}-\tilde{x}\|}{\|b\|}\geq\frac{\|A\|\|x^{*}-\tilde{x}\|}{\|A x^{*}\|}\geq\frac{\|A\|\|x^{*}-\tilde{x}\|}{\|A\|\|x^{*}\|}=\frac{\|x^{*}-\tilde{x}\|}{\|x^{*}\|}$，定理得证。该定理进一步说明了条件数$cond(A)$在估计近似解误差方面的重要性，通过条件数以及余量$r$和右端项$b$的范数，可以对近似解与精确解之间的误差进行估计。在实际计算中，我们可以利用这个定理来评估所得到的近似解的质量，当条件数较大时，即使余量$r$相对较小，也不能保证近似解与精确解非常接近，这也提醒我们在处理病态方程组时需要更加谨慎地对待计算结果的准确性。

### 习题讲解

1. **追赶法的变形与推广相关习题**

    * 例2：将三对角矩阵$A$分解为$A = UL$的形式（$U$为上二对角矩阵，$L$为单位下二对角矩阵）。

      * 对于$n = 4$的情形，通过矩阵乘法对应元素相乘得到计算规律。设$A=\begin{bmatrix}b_{1}&c_{1}&0&0\\a_{2}&b_{2}&c_{2}&0\\0&a_{3}&b_{3}&c_{3}\\0&0&a_{4}&b_{4}\end{bmatrix}$，$U=\begin{bmatrix}d_{1}&u_{1}&0&0\\0&d_{2}&u_{2}&0\\0&0&d_{3}&u_{3}\\0&0&0&d_{4}\end{bmatrix}$，$L=\begin{bmatrix}1&0&0&0\\l_{2}&1&0&0\\0&l_{3}&1&0\\0&0&l_{4}&1\end{bmatrix}$。按矩阵乘法规则可得：$u_{i}=c_{i}$（$i = 1,2,3$）；$d_{4}=b_{4}$，$l_{4}=\frac{a_{4}}{d_{4}}$；$d_{3}=b_{3}-c_{3}l_{4}$，$l_{3}=\frac{a_{3}}{d_{3}}$；$d_{2}=b_{2}-c_{2}l_{3}$，$l_{2}=\frac{a_{2}}{d_{2}}$；$d_{1}=b_{1}-c_{1}l_{2}$。一般地，对于$n$阶三对角矩阵$A$，其分解为$A = UL$时，$U$和$L$矩阵元素的计算顺序为按行计算，先下后上，计算公式为$d_{n}\to l_{n}\to d_{n - 1}\to l_{n - 1}\to\cdots\to d_{2}\to l_{2}\to d_{1}$，其中$\begin{cases}d_{n}=b_{n}\\l_{i + 1}=\frac{a_{i + 1}}{d_{i + 1}},i = n - 1,n - 2,\cdots,1\\d_{i}=b_{i}-c_{i}l_{i + 1}\end{cases}$。
    * 题3：基于上述矩阵分解求解三对角方程组$\begin{cases}b_{1}x_{1}+c_{1}x_{2}=f_{1}\\a_{2}x_{1}+b_{2}x_{2}+c_{2}x_{3}=f_{2}\\\cdots\cdots\cdots\\a_{n - 1}x_{n - 2}+b_{n - 1}x_{n - 1}+c_{n - 1}x_{n}=f_{n - 1}\\a_{n}x_{n - 1}+b_{n}x_{n}=f_{n}\end{cases}$。

      * 令$A = UL$，将$Ax = f$分解为$Uy = f$和$Lx = y$两个方程组求解。对于$Uy = f$，即$\begin{bmatrix}d_{1}&u_{1}&0&0&0\\0&d_{2}&u_{2}&0&0\\0& \ddots&\ddots&\ddots&\ddots\\0&0&0&d_{n - 1}&u_{n - 1}\\0&0&0&0&d_{n}\end{bmatrix}\begin{bmatrix}f_{1}\\f_{2}\\\vdots\\f_{n - 1}\\f_{n}\end{bmatrix}=\begin{bmatrix}b_{1}\\b_{2}\\\vdots\\b_{n - 1}\\b_{n}\end{bmatrix}$，可逆序计算出$y_{n}\to y_{n - 1}\to\cdots\to y_{1}$，其中$y_{n}=\frac{f_{n}}{d_{n}}$，$y_{i}=\frac{f_{i}-c_{i}y_{i + 1}}{d_{i}}$（$i = n - 1,n - 2,\cdots,1$）。对于$Lx = y$，即$\begin{bmatrix}1&0&0&0&0\\l_{2}&1&0&0&0\\0&\ddots&\ddots&\ddots&\ddots\\0&0&l_{n - 1}&1&0\\0&0&0&l_{n}&1\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\\\vdots\\x_{n - 1}\\x_{n}\end{bmatrix}=\begin{bmatrix}y_{1}\\y_{2}\\\vdots\\y_{n - 1}\\y_{n}\end{bmatrix}$，可按顺序计算出$x_{1}\to x_{2}\to\cdots\to x_{n}$，其中$x_{1}=y_{1}$，$x_{i}=y_{i}-l_{i}x_{i - 1}$（$i = 2,3,\cdots,n$）。
2. **三角分解的两种模式相关习题**

    * 题1：设$L$为下三角阵，$L=(l_{ij})_{n×n}$，当$j > i$时$l_{ij}=0$，导出方程组$Lx = b$的求解公式。（求解过程见板书）
    * 题2：设$U$为上三角阵，$U=(u_{ij})_{n×n}$，当$i > j$时$u_{ij}=0$，导出方程组$Ux = b$的求解公式。（求解过程见板书）
    * 题3：设$L$为下三角阵，$L=(l_{ij})_{n×n}$，当$j > i$时$l_{ij}=0$，求出$L^{-1}=(x_{ij})_{n×n}$的计算公式。（求解过程见板书）
    * 题4：考察四阶方阵$A=(a_{ij})_{4×4}$的Doolittle分解$A = LU$，并针对$n$阶方阵$A$列出分解公式。（求解过程见板书）
    * 题5：基于矩阵$A$的Doolittle分解$A = LU$，给出方程组$Ax = b$的求解公式。（求解过程见板书）
    * 题6：考察矩阵$A=(a_{ij})_{n×n}$的Crout分解，并基于这种分解求解方程组$Ax = b$。

      * 由$A = LU$，其中$L=\begin{bmatrix}l_{11}& & & &0\\l_{21}&l_{22}& & &\\l_{31}&l_{32}&l_{33}& &\\\vdots&\vdots&\vdots&\ddots&\\l_{n1}&l_{n2}&l_{n3}&\cdots&l_{n n}\end{bmatrix}$，$U=\begin{bmatrix}1&u_{12}&u_{13}&\cdots&u_{1 n}\\&1&u_{23}&\cdots&u_{2 n}\\& &1&\ddots&\vdots\\& & &\ddots&u_{n - 1 n}\\0& & & &1\end{bmatrix}$，可得$\begin{cases}l_{ij}=a_{ij}-\sum_{k = 1}^{j - 1}l_{ik}u_{kj},j = 1,2,\cdots,i\\u_{ij}=\frac{a_{ij}-\sum_{k = 1}^{i - 1}l_{ik}u_{kj}}{l_{ii}},j = i + 1,i + 2,\cdots,n\end{cases}$。对$i = 1,2,\cdots,n$逐行求出矩阵$L$和$U$的元素。令$Ly = b$和$Ux = y$，得到求解$y$和$x$的表达式为$\begin{cases}y_{i}=\frac{b_{i}-\sum_{j = 1}^{i - 1}l_{ij}y_{j}}{l_{ii}},i = 1,2,\cdots,n\\x_{i}=y_{i}-\sum_{j = i + 1}^{n}u_{ij}x_{j},i = n,n - 1,\cdots,1\end{cases}$。
3. **其他未给出详细求解过程的习题（假设性讲解思路）**

    * 对于求矩阵元素相关的习题（如确定某些矩阵分解中的元素值使等式成立等），通常需要根据已知的矩阵分解形式（如$A = L_{1}D_{1}L_{1}^{T}$等），利用矩阵乘法规则将等式展开，然后通过对比等式两边对应元素来建立方程，进而求解出所需元素的值。这可能涉及到对矩阵乘法运算、对称正定矩阵性质以及各种分解形式特点的深入理解和运用。例如，根据矩阵乘法计算出分解后的矩阵乘积，再根据已知条件（如矩阵元素之间的关系、矩阵的对称性、正定性等）列出方程，最后求解方程得到元素值。在求解过程中，可能需要注意元素的下标范围、计算顺序以及特殊情况的处理等。

### 重点内容总结

1. 消去法：约当消去法、高斯消去法和高斯列主元消去法的原理、计算步骤、算法流程以及适用条件。约当消去法每步在一个方程中保留一个变元并消去其他方程中的该变元；高斯消去法分为消元与回代过程，消元将方程组化为上三角形式；高斯列主元消去法通过选主元避免因主元过小导致的计算误差。
2. 追赶法：三对角方程组的形式、判定有唯一解的条件（对角占优），追赶法的计算过程（追的消元过程和赶的回代过程）及其代数基础（三对角矩阵的$LU$分解），以及如何利用分解求解方程组。
3. 平方根法：对称正定矩阵的$LL^{T}$分解（平方根法）和$LDL^{T}$分解（改进的平方根法）的原理、计算公式，以及基于这些分解求解对称正定方程组的步骤。
4. 误差分析：病态方程组的概念，通过分析右端项和系数矩阵扰动对解的影响引入矩阵条件数$cond(A)$，以及利用条件数估计近似解误差的相关定理。理解条件数越大，方程组病态程度越高，扰动对解的影响越大。
5. 例题与习题：掌握各类例题和习题中涉及的矩阵分解、方程组求解方法，如追赶法变形推广中的矩阵分解与方程组求解，三角分解两种模式（Doolittle分解和Crout分解）相关的计算和方程组求解等。这有助于加深对各种直接法的理解和应用能力。
