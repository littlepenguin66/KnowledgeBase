# 地球物理计算方法第2章数值积分

1. **问题提出** - 函数积分面临原函数难以用初等函数表示、原函数表达式复杂或被积函数无具体解析表达式等困难。
2. **机械求积概念** - 根据积分中值定理，通过对平均高度 $f(\xi)$ 的数值计算得到数值积分方法，如左矩形、右矩形、中矩形、梯形、辛甫生公式等，其特点是求积系数与节点有关，不依赖被积函数具体形式，直接利用被积函数计算积分值。- 机械求积公式 $\int_{a}^{b}f(x)dx \approx \sum_{k=0}^{n}A_{k}f(x_{k})$，其中 $A_{k}$ 为求积系数，$x_{k}$ 为求积节点。
3. **代数精度** - 定义：若求积公式对次数小于等于$m$的多项式准确成立，而对$x^{m+1}$不准确，则称该求积公式具有$m$阶代数精度。通过代入多项式验证等式是否成立来判断代数精度。
4. **插值型求积公式** - 过函数$f(x)$的$n+1$个节点作$n$次插值多项式$p_{n}(x)$，令$\int_{a}^{b}f(x)dx \approx \int_{a}^{b}p_{n}(x)dx$得到插值型求积公式，$A_{k}=\int_{a}^{b}l_{k}(x)dx$（$l_{k}(x)$为插值基函数），$n+1$个节点的求积公式至少具有$n$次代数精度的充要条件是此公式为插值型求积公式。

### （二）Newton-Cotes积分公式

#### 1. 公式导出

* 为了构造数值积分公式，首先将积分区间$[a,b]$进行等距划分。设将区间$[a,b]$分为$n$等份，那么步长$h$就等于$\frac{b - a}{n}$。此时，区间$[a,b]$上的节点$x_{k}$可以表示为$x_{k}=a + kh$，其中$k$的取值范围是从$0$到$n$。
* 基于这些节点，构造插值型求积公式$I_{n}\approx(b - a)\sum_{k = 0}^{n}C_{k}f(x_{k})$。这里的$C_{k}$就是柯特斯系数，它的计算方式是$C_{k}=\frac{1}{b - a}\int_{a}^{b}l_{k}(x)dx$，其中$l_{k}(x)$是插值基函数，其表达式为$l_{k}(x)=\prod_{\substack{j = 0\\j\neq k}}^{n}\frac{x - x_{j}}{x_{k}-x_{j}}$。
* 为了方便计算柯特斯系数$C_{k}$，进行变量代换。令$x - x_{j}=(t - j)h$，同时$x_{k}-x_{j}=(k - j)h$，那么$dx = hdt$。当$x = a$时，$t = 0$；当$x = b$时，$t = n$。经过代换后，$C_{k}=\frac{1}{n\times k!\times(n - k)!}\int_{0}^{n}\prod_{\substack{j = 0\\j\neq k}}^{n}(t - j)dt$。由于柯特斯系数只与$n$有关，与被积函数$f(x)$和积分区间$[a,b]$无关，所以可以预先计算出不同$n$值对应的柯特斯系数，制成表格供使用。

  以下是所有 $n$ 值对应的柯特斯系数，用表格形式列出：

  |$n$|方法名称|柯特斯系数|
  | ---| -----------------| ------------|
  |1|梯形法则|$c_0 = \frac{1}{2}$, $c_1 = \frac{1}{2}$|
  |2|辛普森法则|$c_0 = \frac{1}{3}$, $c_1 = \frac{4}{3}$, $c_2 = \frac{1}{3}$|
  |3|辛普森 3/8 法则|$c_0 = \frac{3}{8}$, $c_1 = \frac{9}{8}$, $c_2 = \frac{9}{8}$, $c_3 = \frac{3}{8}$|
  |4|柯特斯公式|$c_0 = \frac{7}{90}$, $c_1 = \frac{32}{90}$, $c_2 = \frac{12}{90}$, $c_3 = \frac{32}{90}$, $c_4 = \frac{7}{90}$|

  ### 说明：

  1. **$n = 1$**​ **（梯形法则）** ：

      * 区间划分为 1 个子区间。
      * 公式：

        $$
        I_1 = \frac{b - a}{2} \left[ f(x_0) + f(x_1) \right]
        $$
  2. **$n = 2$**​ **（辛普森法则）** ：

      * 区间划分为 2 个子区间。
      * 公式：

        $$
        I_2 = \frac{b - a}{6} \left[ f(x_0) + 4f(x_1) + f(x_2) \right]
        $$
  3. **$n = 3$**​ **（辛普森 3/8 法则）** ：

      * 区间划分为 3 个子区间。
      * 公式：

        $$
        I_3 = \frac{b - a}{8} \left[ f(x_0) + 3f(x_1) + 3f(x_2) + f(x_3) \right]
        $$
  4. **$n = 4$**​ **（柯特斯公式）** ：

      * 区间划分为 4 个子区间。
      * 公式：

        $$
        I_4 = \frac{b - a}{90} \left[ 7f(x_0) + 32f(x_1) + 12f(x_2) + 32f(x_3) + 7f(x_4) \right]
        $$

#### 2. 不同$n$对应的公式及性质

* 当$n = 1$时，得到梯形公式。此时区间$[a,b]$只有两个节点$x_{0}=a$和$x_{1}=b$。根据上述构造的求积公式，$I_{1}\approx(b - a)\sum_{k = 0}^{1}C_{k}f(x_{k})=(b - a)[C_{0}f(x_{0})+C_{1}f(x_{1})]$。通过计算柯特斯系数（$n = 1$时的计算过程）可得$C_{0}=C_{1}=\frac{1}{2}$，所以梯形公式为$I_{1}=\frac{b - a}{2}[f(a)+f(b)]$，其代数精度为$1$次。这意味着对于一次多项式（如$f(x)=mx + c$），梯形公式能精确计算其积分值，但对于二次及更高次多项式则存在一定误差。其误差估计为$R_{1}(f)=\frac{-(b - a)^{3}}{12}f''(\xi)$，其中$\xi\in[a,b]$。这个误差估计式表明，梯形公式的误差与区间长度$(b - a)$的三次方成正比，与被积函数的二阶导数$f''(\xi)$有关。当区间长度越小，被积函数的二阶导数越小，梯形公式的误差就越小。
* 当$n = 2$时，得到辛普生公式。此时区间$[a,b]$有三个节点$x_{0}=a$，$x_{1}=\frac{a + b}{2}$，$x_{2}=b$。同样根据求积公式$I_{2}\approx(b - a)\sum_{k = 0}^{2}C_{k}f(x_{k})$，计算柯特斯系数（$n = 2$时的计算过程）可得$C_{0}=\frac{1}{6}$，$C_{1}=\frac{4}{6}$，$C_{2}=\frac{1}{6}$，所以辛普生公式为$I_{2}=\frac{b - a}{6}[f(a)+4f(\frac{a + b}{2})+f(b)]$，其代数精度为$3$次（因为多项式次数为偶数，实际精度比$n$高$1$阶）。对于三次及以下多项式，辛普生公式能精确计算积分值。其误差估计为$R_{2}(f)=-\frac{(b - a)^{5}}{2880}f^{(4)}(\xi)$，$\xi\in[a,b]$。这说明辛普生公式的误差与区间长度$(b - a)$的五次方成正比，与被积函数的四阶导数$f^{(4)}(\xi)$有关。相比梯形公式，在相同条件下，辛普生公式的误差通常更小，精度更高。
* 当$n = 4$时，得到柯特斯公式。区间$[a,b]$有五个节点$x_{0}=a$，$x_{1}=a + h$，$x_{2}=a + 2h$，$x_{3}=a + 3h$，$x_{4}=b$（其中$h=\frac{b - a}{4}$）。计算相应的柯特斯系数（$n = 4$时的计算过程），得到$C_{0}=\frac{7}{90}$，$C_{1}=\frac{32}{90}$，$C_{2}=\frac{12}{90}$，$C_{3}=\frac{32}{90}$，$C_{4}=\frac{7}{90}$，所以柯特斯公式为$I_{4}=\frac{b - a}{90}[7f(x_{0})+32f(x_{1})+12f(x_{2})+32f(x_{3})+7f(x_{4})]$，代数精度为$5$次。
* 牛顿 - 柯特斯公式具有以下性质：

  * $\sum_{k = 0}^{n}C_{k}=1$。这个性质保证了在某些特殊情况下（如被积函数为常数$1$时），求积公式能得到正确的结果。
  * $C_{n - k}=C_{k}$（$k = 0,1,\cdots,n$），这体现了公式的对称性。这种对称性在计算和理论分析中都有一定的作用，例如可以简化一些计算过程和证明过程。
  * 当$n\leq7$时，牛顿 - 柯特斯系数为正；当$n\geq8$时，系数出现负值，此时公式不稳定。系数为正使得在计算积分近似值时，各项的贡献方向相同，有助于保证计算的稳定性。而当系数出现负值时，可能会导致在计算过程中出现抵消等不稳定现象，影响计算结果的准确性。

#### 3. 低阶求积公式的代数精度

* 一般而言，$n$阶牛顿 - 柯特斯公式至少具有$n$阶代数精度。这是因为在构造公式时，通过使求积公式对于$f(x)=1,x,x^{2},\cdots,x^{n}$这些多项式都精确成立来确定系数$C_{k}$，所以对于次数小于等于$n$的多项式，求积公式理论上应该能精确计算积分值。
* 当$n$为偶数时，其精度可以达到$n + 1$阶。这是牛顿 - 柯特斯公式的一个重要特性。例如，梯形公式（$n = 1$）虽然是$1$阶公式，但对于二次函数（如$f(x)=x^{2}$）也能得到较为准确的积分近似值；辛普生公式（$n = 2$）是$3$阶精度，对于四次函数也有一定的精确性。这种特性使得在实际应用中，当需要计算积分时，如果对精度要求不是特别高且计算量有限制时，可以优先选择偶数阶的牛顿 - 柯特斯公式，如辛普生公式，以在较少的计算量下获得相对较高的精度。同时，理解这一特性也有助于在分析和比较不同数值积分方法时，更好地评估牛顿 - 柯特斯公式的优势和局限性。例如，与其他数值积分方法相比，在相同计算复杂度下，偶数阶牛顿 - 柯特斯公式可能在处理某些类型函数的积分时能提供更高的精度。但当$n$较大（$n\geq8$）时，由于系数出现负值导致公式不稳定，可能需要采用其他更稳定的数值积分方法，如复化求积方法等，来保证计算结果的可靠性。

### （三）复化求积方法

#### 复化求积

1. **复化求积公式的背景与基本思想**

* 背景：在数值积分中，牛顿 - 柯特斯公式随着求积节点增多，代数精度会提高，但高次牛顿 - 柯特斯公式（$n\geq8$）存在计算不稳定的问题。例如，其系数会出现负值，导致在计算过程中可能出现抵消等不稳定现象，影响计算结果的准确性。
* 基本思想：为克服这一问题，采用分段求积分的方法，即复化求积方法。将积分区间$[a,b]$划分为$n$等分，分点为$x_{k}=a + kh$（$k = 0,1,\cdots,n$），其中$h=\frac{b - a}{n}$。然后在每个小区间$[x_{k},x_{k + 1}]$上采用次数不高的牛顿 - 柯特斯求积公式（如梯形公式或辛甫生公式），最后将每个区间上的近似积分值求和，用所得的值近似代替原积分值。

2. **复化梯形公式**

* 公式推导：在每个小区间$[x_{k},x_{k + 1}]$上应用梯形公式

$$
\int_{x_{k}}^{x_{k + 1}}f(x)dx\approx\frac{h}{2}[f(x_{k})+f(x_{k + 1})]
$$

那么对整个区间$[a,b]$上的积分$I=\int_{a}^{b}f(x)dx$，其近似值$T_{n}$为

$$
T_{n}=\sum_{i = 0}^{n - 1}\frac{h}{2}[f(x_{i})+f(x_{i + 1})]
$$

将其展开可得

$$
T_{n}=\frac{h}{2}[f(x_{0})+2\sum_{i = 1}^{n - 1}f(x_{i})+f(x_{n})]
$$

其中$x_{0}=a$，$x_{n}=b$。

* 余项与收敛性：复化梯形公式的余项$R = I - T_{n}=\sum_{i = 0}^{n - 1}[-\frac{1}{12}h^{3}f''(h_{i})]$，其中$h_{i}\in[x_{i},x_{i + 1}]$。进一步分析可知，若$f''(x)$在$[a,b]$上连续，则

$$
R =-\frac{n}{12}h^{3}f''(\xi)=-\frac{b - a}{12}h^{2}f''(\xi)
$$

（$\xi\in[a,b]$）。当$n\rightarrow\infty$时，$h=\frac{b - a}{n}\rightarrow0$，$h^{2}\rightarrow0$，所以$R\rightarrow0$，这表明复化梯形公式是收敛的。例如，对于函数$f(x)=x^{2}$在区间$[0,1]$上的积分，随着$n$的增大，复化梯形公式计算得到的近似值会越来越接近准确值$\frac{1}{3}$。

3. **复化辛甫生公式**

* 公式推导：在每个小区间$[x_{k},x_{k + 1}]$上应用辛甫生公式

$$
\int_{x_{k}}^{x_{k + 1}}f(x)dx\approx\frac{h}{6}[f(x_{k})+4f(x_{k+\frac{1}{2}})+f(x_{k + 1})]
$$

（其中$x_{k+\frac{1}{2}}=x_{k}+\frac{1}{2}h$），对整个区间$[a,b]$积分的近似值$S_{n}$为

$$
S_{n}=\sum_{k = 0}^{n - 1}\frac{h}{6}[f(x_{k})+4f(x_{k+\frac{1}{2}})+f(x_{k + 1})]
$$

展开可得

$$
S_{n}=\frac{h}{6}[f(a)+4\sum_{i = 0}^{n - 1}f(x_{i+\frac{1}{2}})+2\sum_{i = 1}^{n - 1}f(x_{i})+f(b)]
$$

* 余项与收敛性：当$f\in C^{4}[a,b]$时，复化辛甫生公式的余项

$$
R = I - S_{n}=-\frac{b - a}{180}\left(\frac{h}{2}\right)^{4}f^{(4)}(\eta)=-\frac{b - a}{2880}h^{4}f^{(4)}(\eta)
$$

（$\eta\in(a,b)$）。同样，当$n\rightarrow\infty$时，$h\rightarrow0$，$h^{4}\rightarrow0$，$R\rightarrow0$，说明复化辛甫生公式也是收敛的。对于一些光滑性较好的函数，复化辛甫生公式比复化梯形公式能更快地收敛到准确值，因为其误差项中$h$的次数更高，收敛速度更快。例如对于$f(x)=\sin x$在$[0,\pi]$上的积分，复化辛甫生公式在较小的$n$值时就能得到比较精确的近似值。

4. **复化柯特斯公式**

* 公式：

$$
C_{n}=\frac{h}{90}[7f(a)+32\sum_{i = 0}^{n - 1}f(x_{i+\frac{1}{4}})+12\sum_{i = 0}^{n - 1}f(x_{i+\frac{1}{2}})+32\sum_{i = 0}^{n - 1}f(x_{i+\frac{3}{4}})+14\sum_{i = 1}^{n - 1}f(x_{i})+7f(b)]
$$

其中$x_{i+\frac{1}{4}}$，$x_{i+\frac{1}{2}}$，$x_{i+\frac{3}{4}}$为子区间内的$4$等分点。

* 特点：复化柯特斯公式在计算上相对复杂一些，但在精度上可能会更高，适用于对精度要求较高的情况。不过，随着$n$的增大，计算量也会相应增加，需要在精度和计算成本之间进行权衡。

5. **复化求积方法的优势与应用场景**

* 优势：复化求积方法有效地克服了高次牛顿 - 柯特斯公式的不稳定问题，通过将区间细分，在每个小区间上使用低次求积公式，既保证了计算的稳定性，又能在一定程度上提高精度。而且其运算相对简单，易于在计算机上实现。例如，在计算机编程中，可以通过循环结构方便地计算每个小区间上的积分近似值并求和。
* 应用场景：适用于各种需要数值积分的场合，特别是当被积函数的原函数难以求出或者被积函数没有具体解析表达式（仅由表格或图形给出）时。在科学计算、工程计算、物理等领域中，很多实际问题的积分计算都可以采用复化求积方法。例如计算不规则图形的面积、物理系统中的能量积分等。同时，在对精度要求不是极高但需要保证计算稳定性的情况下，复化梯形公式或复化辛甫生公式是比较常用的选择；而当对精度要求较高且计算资源允许时，可以考虑使用复化柯特斯公式。

复化公式（Composite Formulas）是将积分区间 $[a, b]$ 划分为多个子区间，并在每个子区间上应用低阶牛顿-柯特斯公式（如梯形法则、辛普森法则等）。以下是复化后的系数表格：

---

### **复化公式系数表格**

|方法名称|子区间数 $n$|节点数 $n+1$|复化系数公式|复化公式形式|
| ---------------------| -----------| ---------| --------------| --------------|
|复化梯形法则|$n$|$n+1$|$h = \frac{b - a}{n}$, 系数为 $1, 2, 2, \dots, 2, 1$|$I_{\text{复化梯形}} = \frac{h}{2} \left[ f(x_0) + 2\sum_{i=1}^{n-1} f(x_i) + f(x_n) \right]$|
|复化辛普森法则|$2n$|$2n+1$|$h = \frac{b - a}{2n}$, 系数为 $1, 4, 2, 4, 2, \dots, 4, 1$|$I_{\text{复化辛普森}} = \frac{h}{3} \left[ f(x_0) + 4\sum_{i=1,3,\dots}^{2n-1} f(x_i) + 2\sum_{i=2,4,\dots}^{2n-2} f(x_i) + f(x_{2n}) \right]$|
|复化辛普森 3/8 法则|$3n$|$3n+1$|$h = \frac{b - a}{3n}$, 系数为 $1, 3, 3, 2, 3, 3, 2, \dots, 3, 3, 1$|$I_{\text{复化辛普森 3/8}} = \frac{3h}{8} \left[ f(x_0) + 3\sum_{i=1,2,4,5,\dots}^{3n-1} f(x_i) + 2\sum_{i=3,6,\dots}^{3n-3} f(x_i) + f(x_{3n}) \right]$|
|复化柯特斯公式|$4n$|$4n+1$|$h = \frac{b - a}{4n}$, 系数为 $7, 32, 12, 32, 14, 32, 12, 32, \dots, 7$|$I_{\text{复化柯特斯}} = \frac{h}{90} \left[ 7f(x_0) + 32\sum_{i=1,3,\dots}^{4n-1} f(x_i) + 12\sum_{i=2,6,\dots}^{4n-2} f(x_i) + 14\sum_{i=4,8,\dots}^{4n-4} f(x_i) + 7f(x_{4n}) \right]$|

---

### **说明**

1. **复化梯形法则**：

    * 每个子区间应用梯形法则。
    * 系数为 $1, 2, 2, \dots, 2, 1$。
2. **复化辛普森法则**：

    * 每两个子区间应用辛普森法则。
    * 系数为 $1, 4, 2, 4, 2, \dots, 4, 1$。
3. **复化辛普森 3/8 法则**：

    * 每三个子区间应用辛普森 3/8 法则。
    * 系数为 $1, 3, 3, 2, 3, 3, 2, \dots, 3, 3, 1$。
4. **复化柯特斯公式**：

    * 每四个子区间应用柯特斯公式。
    * 系数为 $7, 32, 12, 32, 14, 32, 12, 32, \dots, 7$。

---

### **示例**

#### **复化梯形法则（**​**$n = 4$**​ **）**

* 节点数：5
* 系数：$1, 2, 2, 2, 1$
* 公式：

  $$
  I_{\text{复化梯形}} = \frac{h}{2} \left[ f(x_0) + 2f(x_1) + 2f(x_2) + 2f(x_3) + f(x_4) \right]
  $$

#### **复化辛普森法则（**​**$n = 2$**​ **）**

* 节点数：5
* 系数：$1, 4, 2, 4, 1$
* 公式：

  $$
  I_{\text{复化辛普森}} = \frac{h}{3} \left[ f(x_0) + 4f(x_1) + 2f(x_2) + 4f(x_3) + f(x_4) \right]
  $$

---

### （四）Romberg求积公式

#### 1. 梯形法加速

* **梯形法的不足与加速思路**：梯形法算法简单，但精度低、收敛慢。其误差公式为$I - T_{n} \approx \frac{1}{3}(T_{2n}-T_{n})$，这表明梯形法的误差与步长$h$的平方成正比，步长减半后误差将减至约$\frac{1}{4}$。基于此，我们可以对梯形值进行加速以提高精度。
* **辛普生公式的导出**：设$S_{n}=(1 + \omega)T_{2n}-\omega T_{n}$，根据误差关系，当$\omega=\frac{1}{3}$时，$S_{n}=T_{2n}+\frac{T_{2n}-T_{n}}{3}$，这个公式就是辛普生公式。它是对梯形值的一种加速，其代数精度为$3$次（对于次数小于等于$3$的多项式能精确成立积分等式）。例如，对于$f(x)=x^3$在区间$[a,b]$上的积分，辛普生公式能比梯形公式更精确地逼近准确值。

#### 2. 辛普生法再加速

* **辛普生法误差分析与再加速原理**：辛普生法的误差公式为$I - S_{n} \approx \frac{1}{15}(S_{2n}-S_{n})$，这意味着其误差与步长$h$的四次方成正比，步长减半后误差将减至约$\frac{1}{16}$。为了进一步提高精度，我们可以再次利用误差关系对辛普生值进行加速。
* **柯特斯公式的导出**：设$C_{n}=(1 + \omega)S_{2n}-\omega S_{n}$，当$\omega=\frac{1}{15}$时，$C_{n}=S_{2n}+\frac{S_{2n}-S_{n}}{15}$，此即柯特斯公式。柯特斯公式的代数精度为$5$次，比辛普生公式的精度更高。对于一些光滑性较好的函数，柯特斯公式能够更准确地计算积分值。例如，在计算$f(x)=\sin(x^2)$在区间$[0,1]$上的积分时，柯特斯公式的近似结果比辛普生公式更接近准确值。

#### 3. Romberg公式

* **重复加速手续与Romberg公式的导出**：重复上述加速过程，依据柯特斯法的误差公式$I - C_{n} \approx \frac{1}{63}(C_{2n}-C_{n})$，设$R_{n}=(1 + \omega)C_{2n}-\omega C_{n}$，当$\omega=\frac{1}{63}$时，得到龙贝格公式$R_{n}=C_{2n}+\frac{C_{2n}-C_{n}}{63}$。Romberg公式也称为逐次分半加速法，它是在梯形公式、辛普森公式和柯特斯公式之间关系的基础上构造出的一种加速计算积分的方法。
* **Romberg算法的一般公式与性质**：Romberg算法的一般递推公式为$T_{m}^{(k)}=\frac{4^{m}}{4^{m}-1}T_{m - 1}^{(k + 1)}-\frac{1}{4^{m}-1}T_{m - 1}^{(k)}$，其中$k$表示每个区间二分的次数，等分的区间总个数为$n = 2^{k}$，$m$表示第几次加速。Romberg算法的代数精度为$2m$次，收敛阶为$2(m + 1)$阶。这意味着随着加速次数的增加，Romberg公式的精度会快速提高，收敛速度也更快。例如，在计算一些复杂函数的积分时，经过几次加速后，Romberg公式得到的结果能达到很高的精度。

#### 4. Romberg算法的实现

* **计算流程与步骤**：

  * 首先用梯形公式计算积分近似值$T_{1}=\frac{b - a}{2}[f(a)+f(b)]$。
  * 然后按变步长梯形公式计算积分近似值，将区间逐次分半，令区间长度$h=\frac{b - a}{2^{k}}$（$k = 0,1,2,\cdots$），计算$T_{2n}=\frac{T_{n}}{2}+\frac{h}{2}\sum_{k = 0}^{n - 1}f(x_{k+\frac{1}{2}})$。
  * 接着按加速公式求加速值，如辛甫生加速公式$S_{n}=T_{2n}+\frac{T_{2n}-T_{n}}{3}$，柯特斯加速公式$C_{n}=S_{2n}+\frac{S_{2n}-S_{n}}{15}$，龙贝格求积公式$R_{n}=C_{2n}+\frac{C_{2n}-C_{n}}{63}$。在计算过程中，通过比较二分前后的差$\Delta$与允许的误差$\varepsilon$来控制精度。如果$|\Delta|<\varepsilon$，则停止计算并输出积分值；否则继续二分区间进行计算。
* **Romberg算法的优势**：Romberg算法作为一种外推算法，在不增加计算量的前提下提高了误差的精度。它通过巧妙地利用梯形法、辛普森法和柯特斯法之间的关系，逐步改进积分近似值，使得计算结果能够快速收敛到准确值。与其他数值积分方法相比，在达到相同精度要求的情况下，Romberg算法通常需要较少的计算步骤，提高了计算效率。例如，在计算$\int_{0}^{1}e^{-x^2}dx$这样的积分时，Romberg算法能够在较短时间内得到高精度的近似结果，而其他一些方法可能需要更多的计算资源或计算时间才能达到类似的精度。

### （五）Gauss积分公式

#### 1. 公式定义

* **基本形式与代数精度要求**：Gauss积分公式为$\int_{-1}^{1}f(x)dx\approx\sum_{k = 1}^{n}A_{k}f(x_{k})$，其核心思想是通过适当地选取求积节点$x_{k}$（$k = 1,2,\cdots,n$）和系数$A_{k}$，使求积公式具有$2n - 1$次代数精度。这意味着对于次数小于等于$2n - 1$的多项式，该公式能精确计算其积分值，而对于$2n$次及以上多项式则为近似计算。例如，当$n = 2$时，公式应对于$f(x)=1,x,x^{2},x^{3}$等多项式都能精确成立积分等式。

* **与其他积分公式的区别**：与之前的牛顿 - 柯特斯积分公式不同，Gauss积分公式的节点不是等距分布的，而是根据代数精度要求进行优化选取的。这种非等距节点的选取方式使得Gauss积分公式在相同节点数量下能够获得更高的代数精度。例如，牛顿 - 柯特斯公式中梯形公式（$n = 1$）只有$1$次代数精度，辛普生公式（$n = 2$）有$3$次代数精度，而两点Gauss公式（$n = 2$）却能达到$3$次代数精度，比梯形公式精度更高。

#### 2. [高斯点](高斯点.md)特性

* **正交性与高斯点的关系**：以高斯点$x_{k}$（$k = 1,2,\cdots,n$）为根的$n$次多项式$\omega(x)=(x - x_{1})(x - x_{2})\cdots(x - x_{n})$与一切次数$\leq n - 1$次的多项式正交，即$\int_{-1}^{1}x^{k}\omega(x)dx = 0$（$k = 0,1,\cdots,n - 1$）。反之，如果$n$次多项式$\omega(x)$与任意$n - 1$次的多项式正交，那么其零点就是高斯点。这一特性为确定高斯点提供了理论依据，通过求解上述正交性条件下的方程，可以得到高斯点的值。
* **利用正交性求高斯点的方法**：例如，对于两点Gauss公式（$n = 2$），设$\int_{-1}^{1}f(x)dx\approx A_{1}f(x_{1})+A_{2}f(x_{2})$，根据代数精度定义，代入$f(x)=1,x,x^{2},x^{3}$建立方程组$\left\{\begin{array}{l}A_{1}+A_{2}=2\\A_{1}x_{1}+A_{2}x_{2}=0\\A_{1}x_{1}^{2}+A_{2}x_{2}^{2}=\frac{2}{3}\\A_{1}x_{1}^{3}+A_{2}x_{2}^{3}=0\end{array}\right.$，求解该方程组可得到$x_{1}=-\frac{1}{\sqrt{3}}$，$x_{2}=\frac{1}{\sqrt{3}}$，$A_{1}=A_{2}=1$，从而确定了两点Gauss公式。

#### 3. 勒让德多项式

* **定义与作用**：以高斯点为零点的$n$次多项式称为勒让德多项式$p_{n}(x)=\frac{n!}{(2n)!}\frac{d^{n}}{dx^{n}}[(x^{2}-1)^{n}]$。勒让德多项式的零点即为高斯点，所以可以通过求勒让德多项式的零点来确定Gauss积分公式中的节点。例如，$p_{2}(x)=x^{2}-\frac{1}{3}$，令$p_{2}(x)=0$，解得$x=\pm\frac{1}{\sqrt{3}}$，这就是两点Gauss公式中的节点。
* **构造高斯公式的过程**：先构造出==勒让德多项式，然后求其零点得到高斯点==，再将高斯点代入积分公式中，通过一些计算（如利用正交性条件建立方程求解系数$A_{k}$）来确定积分系数，从而构造出完整的Gauss积分公式。不同阶数的勒让德多项式对应不同的高斯点和系数，从而形成不同精度的Gauss积分公式。如$p_{3}(x)=x^{3}-\frac{3}{5}x$，其零点可用于构造三点Gauss公式等。

#### 4. 高斯积分公式的特点

* **收敛性**：当$n\rightarrow\infty$时，Gauss积分公式收敛到积分值。这意味着随着高斯点数量的增加，计算结果会越来越接近真实的积分值，保证了公式在理论上的可靠性。例如，对于一些复杂的积分，如$\int_{-1}^{1}e^{-x^{2}}dx$，随着$n$的增大，Gauss积分公式的近似值会逐渐趋近于准确值。
* **数值稳定性好**：在计算过程中，Gauss积分公式能够较好地控制误差的传播，避免因计算过程中的舍入误差等因素导致结果出现较大偏差。这使得它在实际计算中能够稳定地给出较为准确的结果，尤其适用于需要高精度计算的场合。
* **内在对称性**：Gauss积分公式具有内在的对称性，包括系数和节点的对称性。这种对称性不仅在理论分析中有一定的作用，在实际计算中也有助于简化计算过程和提高计算效率。例如，在计算积分时，可以利用对称性减少一些不必要的计算。
* **计算困难与解决方法**：Gauss积分公式的一个困难在于确定求积系数与求积节点时，用代数精度方法归结出的代数方程组是非线性的。解决这一问题的方法是从研究高斯点多项式的基本特性（如正交性）着手，通过勒让德多项式等工具来确定高斯点和系数，从而构造出Gauss积分公式。

#### 5. 任意区间的推广

* **变量替换方法**：对于任意区间$[a,b]$的积分，通过变量替换$x=\frac{b - a}{2}t+\frac{a + b}{2}$（$t\in[-1,1]$），将原积分区间变换到$[-1,1]$。然后将新变量$t$的高斯点代入函数中，应用Gauss公式求积分系数。例如，两点Gauss公式在任意区间$[a,b]$上的积分公式为$\int_{a}^{b}f(x)dx\approx\frac{b - a}{2}[f(\frac{b - a}{2}(-\frac{1}{\sqrt{3}})+\frac{a + b}{2})+f(\frac{b - a}{2}(\frac{1}{\sqrt{3}})+\frac{a + b}{2})]$。这种推广使得Gauss积分公式能够应用于更广泛的积分计算场景，而不仅仅局限于$[-1,1]$区间。

### （六）数值微分

#### 1. 差商公式

* **导数定义与差商近似**：由导数定义$f^{\prime}(a)=\lim_{h\rightarrow0}\frac{f(a + h)-f(a)}{h}$，当$h$取有限值时，用差商近似导数得到数值微分公式。例如，$f^{\prime}(a)\approx\frac{f(a + h)-f(a)}{h}$（前向差商），$f^{\prime}(a)\approx\frac{f(a)-f(a - h)}{h}$（后向差商），$f^{\prime}(a)\approx\frac{f(a + h)-f(a - h)}{2h}$（中点公式）。中点公式在一定程度上比前向和后向差商公式更精确，因为它利用了$a$点两侧的函数值信息。
* **误差分析**：中点公式的误差$R$与$h^{2}$成正比，即$G(h)=\frac{f(a + h)-f(a - h)}{2h}=f^{\prime}(a)+\frac{h^{2}}{3!}f^{\prime\prime\prime}(a)+\frac{h^{4}}{5!}f^{(5)}(a)+\cdots$。从截断误差角度看，$h$越小，截断误差越小；但从舍入误差角度看，$h$不能太小，因为当$h$过小时，$f(a + h)$与$f(a - h)$太接近，会导致舍入误差增大。所以在实际计算时需要选择一个合适的$h$值，以平衡截断误差和舍入误差。例如，对于函数$f(x)=\sin x$在$x = 0$处求导，若$h$取过大或过小的值，都会使计算得到的导数近似值不准确。

#### 2. 中点方法加速

* **中点格式与步长减半时的误差变化**：中点格式为$G(h)=\frac{f(a + h)-f(a - h)}{2h}=f^{\prime}(a)+\frac{h^{2}}{3!}f^{\prime\prime\prime}(a)+\frac{h^{4}}{5!}f^{(5)}(a)+\cdots$。当步长减半，即$h/2$时，$G\left(\frac{h}{2}\right)=f^{\prime}(a)+\frac{1}{2^{2}}\frac{h^{2}}{3!}f^{\prime\prime\prime}(a)+\frac{1}{2^{4}}\frac{h^{4}}{5!}f^{(5)}(a)+\cdots$。通过分析步长为$h$和$h/2$时的误差表达式，可以发现步长减半后误差的变化规律，从而为加速方法提供理论基础。
* **加速公式的推导与性质**：由$G(h)-f^{\prime}(a)=\frac{h^{2}}{3!}f^{\prime\prime\prime}(a)+\frac{h^{4}}{5!}f^{(5)}(a)+\cdots$和$G\left(\frac{h}{2}\right)-f^{\prime}(a)=\frac{(h/2)^{2}}{3!}f^{\prime\prime\prime}(a)+\frac{(h/2)^{4}}{5!}f^{(5)}(a)+\cdots$，两式相减可得$G(h)-G\left(\frac{h}{2}\right)=3\frac{(h/2)^{2}}{3!}f^{\prime\prime\prime}(a)+15\frac{(h/2)^{4}}{5!}f^{(5)}(a)+\cdots$，进一步整理得到$\frac{(h/2)^{2}}{3!}f^{\prime\prime\prime}(a)\approx\frac{1}{3}\left[G(h)-G\left(\frac{h}{2}\right)\right]$，将其代入$G\left(\frac{h}{2}\right)-f^{\prime}(a)=\frac{(h/2)^{2}}{3!}f^{\prime\prime\prime}(a)+\frac{(h/2)^{4}}{5!}f^{(5)}(a)+\cdots$中，移项整理可得$G_{1}(h)=\frac{4}{3}G\left(\frac{h}{2}\right)-\frac{1}{3}G(h)=f^{\prime}(a)+\beta_{1}h^{4}+\beta_{2}h^{6}+\cdots$，其中$G_{1}(h)$为$f^{\prime}(a)$的加速公式，其截断误差主项为$O(h^{4})$。若再令$G_{2}(h)=\frac{16}{15}G_{1}\left(\frac{h}{2}\right)-\frac{1}{15}G_{1}(h)$，则$G_{2}(h)=f^{\prime}(a)+\gamma_{1}h^{6}+\cdots$，$G_{2}(h)$的截断误差主项为$O(h^{6})$。通过不断重复这样的加速过程，可以逐步提高数值微分的精度。

#### 3. 数值求导公式设计方法

* **代数精度构造法**：已知一组节点$x_{i}=x_{0}+ih$（$i = 0,1,\cdots,n$）及对应的函数值$f(x_{i})$，构造$f^{\prime}(x_{k})\approx\sum_{i = 0}^{n}A_{i}f(x_{i})$。令它对于$f(x)=1,x,x^{2},\cdots$成立等式，通过解方程组来确定系数$A_{i}$，使该微分格式具有一定的代数精度。例如，对于求$f^{\prime}(x_{0})$，令$f^{\prime}(x_{0})\approx\frac{1}{h}(A_{0}f(x_{0})+A_{1}f(x_{1})+A_{2}f(x_{2}))$具有$2$阶精度，代入$f(x)=1,x,x^{2}$得到方程组

  $$
  \left\{
  \begin{array}{l}
  A_{0}+A_{1}+A_{2}=0 \\
  A_{0}x_{0}+A_{1}x_{1}+A_{2}x_{2}=2x_{0}h \\
  A_{0}x_{0}^{2}+A_{1}x_{1}^{2}+A_{2}x_{2}^{2}=2x_{0}^{2}h^{2}
  \end{array}
  \right.
  $$

  解方程组可得$A_{0}=-\frac{3}{2},A_{1}=2,A_{2}=-\frac{1}{2}$，即$f^{\prime}(x_{0})\approx\frac{1}{2h}(-3f(x_{0})+4f(x_{1})-f(x_{2}))$。
* **插值多项式构造方法**：构造插值多项式$p_{n}(x)$，已知函数$y = f(x)$在节点上的函数值$y_{i}=f(x_{i})$（$i = 0,1,\cdots,n$），取$f^{\prime}(x)=p_{n}^{\prime}(x)$，则称为插值型求导公式。例如，对于两点公式，已知$x_{0},x_{1}$两点的函数值$f(x_{0})$和$f(x_{1})$，作线性插值$p_{1}(x)=\frac{x - x_{1}}{x_{0}-x_{1}}f(x_{0})+\frac{x - x_{0}}{x_{1}-x_{0}}f(x_{1})$，对其求导可得$p_{1}^{\prime}(x)=\frac{1}{h}[-f(x_{0})+f(x_{1})]$（其中$h = x_{1}-x_{0}$），所以$f^{\prime}(x_{0})\approx p_{1}^{\prime}(x_{0})=\frac{1}{h}[f(x_{1})-f(x_{0})]$，$f^{\prime}(x_{1})\approx p_{1}^{\prime}(x_{1})=\frac{1}{h}[f(x_{1})-f(x_{0})]$。对于三点公式，已知$x_{0},x_{1},x_{2}$三点的函数值，作二次插值$p_{2}(x)$，对$p_{2}(x)$求导并代入$t = 0,1,2$（$x = x_{0}+th$，$x_{0},x_{1}=x_{0}+h,x_{2}=x_{0}+2h$）可得到三个节点处的求导公式，如$f^{\prime}(x_{0})\approx p_{2}^{\prime}(x_{0})=\frac{1}{2h}[-3f(x_{0})+4f(x_{1})-f(x_{2})]$等。

#### 4. 高阶导数公式

* **基于插值多项式的构造**：可以根据插值多项式构造高阶导数公式，如$f^{\prime\prime}(x)\approx p_{n}^{\prime\prime}(x)$等。例如，对于二次插值多项式$p_{2}(x)$，其二阶导数$p_{2}^{\prime\prime}(x)=\frac{1}{h^{2}}[f(x_{0})-2f(x_{1})+f(x_{2})]$，令$x = x_{1}$（即$t = 1$），可得$f^{\prime\prime}(x_{1})\approx\frac{1}{h^{2}}[f(x_{0})-2f(x_{1})+f(x_{2})]$。通过这种方式，可以利用插值多项式来近似计算函数的高阶导数，在一些需要计算高阶导数但解析计算困难的情况下提供了一种数值计算的方法。但需要注意的是，随着导数阶数的增加，插值多项式求导的误差可能会增大，在实际应用中需要根据具体情况评估计算结果的准确性。

## 二、课堂测验讲解

#### 1. 用梯形公式、辛甫生公式和柯特斯公式计算定积分$\int_{0.5}^{1}\sqrt{x}dx$的近似值（计算结果取5位有效数字），并与积分准确值比较，分析三种求积公式的精度。

2. 用变步长梯形求积法计算定积分$I=\int_{0}^{1}\frac{\sin x}{x}dx$，$\varepsilon = 10^{-2}$。
3. 用Romberg算法计算定积分$I=\int_{0}^{1}\frac{\sin x}{x}dx$。
4. 求函数$f(x)=e^{x}$在$x = 1$处的导数值（近似值要求三位有效数字），分别用中点公式、中点加速公式$G_{1}(h)$和$G_{2}(h)$计算，并分析结果。

#### 解答

1. **定积分近似值计算与精度分析**

    * 梯形公式：$\int_{0.5}^{1}\sqrt{x}dx \approx \frac{1 - 0.5}{2}[f(0.5)+f(1)]=\frac{1}{4}(\sqrt{0.5}+1)=0.42678$。
    * 辛甫生公式：$\int_{0.5}^{1}\sqrt{x}dx \approx \frac{1 - 0.5}{6}[\sqrt{0.5}+4\sqrt{(0.5 + 1)/2}+\sqrt{1}]=\frac{1}{12}(0.70711 + 4\times0.86603 + 1)=0.43093$。
    * 柯特斯公式：系数为$\frac{7}{90},\frac{32}{90},\frac{12}{90},\frac{32}{90},\frac{7}{90}$，$\int_{0.5}^{1}\sqrt{x}dx \approx \frac{1 - 0.5}{90}[7\sqrt{0.5}+32\sqrt{0.625}+12\sqrt{0.75}+32\sqrt{0.875}+7\sqrt{1}]=\frac{1}{180}(4.94975 + 25.29822 + 10.39223 + 29.93326 + 7)=0.43096$。
    * 积分准确值为$\int_{0.5}^{1}\sqrt{x}dx=\frac{2}{3}x^{\frac{3}{2}}\big|_{0.5}^{1}=0.43096$。
    * 精度分析：梯形公式误差$\vert0.42678 - 0.43096\vert = 0.00418$；辛甫生公式误差$\vert0.43093 - 0.43096\vert = 0.00003$；柯特斯公式误差$\vert0.43096 - 0.43096\vert = 0.00000$。可见三种求积公式精度逐渐提高，柯特斯公式精度最高，梯形公式精度最低。
2. **变步长梯形求积法计算定积分**

    * 首先计算$T_{1}=\frac{1}{2}[f(0)+f(1)]=\frac{1}{2}(1 + 0.841471)=0.92074$。
    * 已知$f(\frac{1}{2}) = 0.95885$，则$T_{2}=\frac{1}{2}T_{1}+\frac{1}{2}f(\frac{1}{2})=\frac{1}{2}\times0.92074+\frac{1}{2}\times0.95885 = 0.93980$，$\vert T_{2}-T_{1}\vert = 0.019 > \varepsilon$。
    * 二分一次后，新分点$f(\frac{1}{4}) = 0.98962$，$f(\frac{3}{4}) = 0.90885$，$T_{4}=\frac{1}{2}T_{2}+\frac{1}{4}[f(\frac{1}{4})+f(\frac{3}{4})]=\frac{1}{2}\times0.93980+\frac{1}{4}(0.98962 + 0.90885)=0.94451$，$\vert T_{4}-T_{2}\vert = \vert0.94451 - 0.93980\vert = 0.00471 < \varepsilon$，所以$I \approx T_{4}=0.945$。
3. **Romberg算法计算定积分**

    * 首先计算梯形公式的值：

      * $T_{1}=\frac{1 - 0}{2}[f(0)+f(1)]=\frac{1}{2}(1 + 0.841471)=0.92074$。
    * 然后计算变步长梯形公式的值：

      * 当$k = 1$时，$h=\frac{1 - 0}{2}=0.5$，$T_{2}=\frac{T_{1}}{2}+\frac{h}{2}f(0.5)=\frac{0.92074}{2}+\frac{0.5}{2}\times0.95885 = 0.93980$。
      * 当$k = 2$时，$h=\frac{1 - 0}{4}=0.25$，$T_{4}=\frac{T_{2}}{2}+\frac{h}{2}[f(0.25)+f(0.75)]=\frac{0.93980}{2}+\frac{0.25}{2}(0.98962 + 0.90885)=0.94451$。
      * 当$k = 3$时，$h=\frac{1 - 0}{8}=0.125$，$T_{8}=\frac{T_{4}}{2}+\frac{h}{2}[f(0.125)+f(0.375)+f(0.625)+f(0.875)]=\frac{0.94451}{2}+\frac{0.125}{2}(0.99740 + 0.97673 + 0.93616 + 0.88192)=0.94569$。
    * 接着计算辛甫生加速公式的值：

      * $S_{1}=T_{2}+\frac{T_{2}-T_{1}}{3}=0.93980+\frac{0.93980 - 0.92074}{3}=0.94615$。
      * $S_{2}=T_{4}+\frac{T_{4}-T_{2}}{3}=0.94451+\frac{0.94451 - 0.93980}{3}=0.94610$。
      * $S_{4}=T_{8}+\frac{T_{8}-T_{4}}{3}=0.94569+\frac{0.94569 - 0.94451}{3}=0.94608$。
    * 再计算柯特斯加速公式的值：

      * $C_{1}=S_{2}+\frac{S_{2}-S_{1}}{15}=0.94610+\frac{0.94610 - 0.94615}{15}=0.94608$。
      * $C_{2}=S_{4}+\frac{S_{4}-S_{2}}{15}=0.94608+\frac{0.94608 - 0.94610}{15}=0.94608$。
    * 最后计算龙贝格公式的值：

      * $R_{1}=C_{2}+\frac{C_{2}-C_{1}}{63}=0.94608+\frac{0.94608 - 0.94608}{63}=0.94608$。
4. **求函数导数值**

    * 中点公式：

      * $f'{\prime}(1) \approx G(h) = \frac{f(1 + h) - f(1 - h)}{2h} = \frac{e^{1 + h} - e^{1 - h}}{2h}$。
      * 当$h = 0.8$时，$G(0.8) = \frac{e^{1 + 0.8} - e^{1 - 0.8}}{2 \times 0.8} = \frac{e^{1.8} - e^{0.2}}{1.6} \approx 3.01765$。
      * 当$h = 0.4$时，$G(0.4) = \frac{e^{1 + 0.4} - e^{1 - 0.4}}{2 \times 0.4} = \frac{e^{1.4} - e^{0.6}}{0.8} \approx 2.79135$。
      * 当$h = 0.2$时，$G(0.2) = \frac{e^{1 + 0.2} - e^{1 - 0.2}}{2 \times 0.2} = \frac{e^{1.2} - e^{0.8}}{0.4} \approx 2.73644$。
      * 当$h = 0.1$时，$G(0.1) = \frac{e^{1 + 0.1} - e^{1 - 0.1}}{2 \times 0.1} = \frac{e^{1.1} - e^{0.9}}{0.2} \approx 2.72281$。
    * 中点加速公式$G_{1}(h)$：

      * 当$h = 0.8$时，$G_{1}(0.8) = \frac{4}{3}G(0.4) - \frac{1}{3}G(0.8) = \frac{4}{3} \times 2.79135 - \frac{1}{3} \times 3.01765 = 2.71592$。
      * 当$h = 0.4$时，$G_{1}(0.4) = \frac{4}{3}G(0.2) - \frac{1}{3}G(0.4) = \frac{4}{3} \times 2.73644 - \frac{1}{3} \times 2.79135 = 2.71814$。
      * 当$h = 0.2$时，$G_{1}(0.2) = \frac{4}{3}G(0.1) - \frac{1}{3}G(0.2) = \frac{4}{3} \times 2.72281 - \frac{1}{3} \times 2.73644 = 2.71927$。
    * 中点加速公式$G_{2}(h)$：

      * 当$h = 0.8$时，$G_{2}(0.8) = \frac{16}{15}G_{1}(0.4) - \frac{1}{15}G_{1}(0.8) = \frac{16}{15} \times 2.71814 - \frac{1}{15} \times 2.71592 = 2.71828$。
      * 当$h = 0.4$时，$G_{2}(0.4) = \frac{16}{15}G_{1}(0.2) - \frac{1}{15}G_{1}(0.4) = \frac{16}{15} \times 2.71927 - \frac{1}{15} \times 2.71814 = 2.71828$（这里根据前面计算$G_{1}(0.2)$和$G_{1}(0.4)$的值代入计算得出）。

#### 结果分析

1. 在计算定积分$\int_{0.5}^{1}\sqrt{x}dx$时，从三种求积公式的结果与准确值的误差比较可以看出，随着公式的改进，精度不断提高。梯形公式相对简单，但误差较大；辛甫生公式通过更合理地利用节点函数值，精度有明显提升；柯特斯公式进一步优化，误差更小。这体现了不同求积公式在数值积分中的特点和优势，在实际应用中可根据对精度的要求选择合适的公式。
2. 对于变步长梯形求积法计算$\int_{0}^{1}\frac{\sin x}{x}dx$，通过不断二分区间，利用递推关系计算梯形值，直到满足给定精度$\varepsilon = 10^{-2}$。这种方法在保证一定精度的前提下，有效地减少了计算量，避免了一开始就使用过小步长导致计算量过大的问题。同时，也展示了如何通过迭代改进数值积分的近似值，使其逐渐逼近准确值。
3. Romberg算法在计算$\int_{0}^{1}\frac{\sin x}{x}dx$时，通过梯形公式、辛甫生加速公式、柯特斯加速公式和龙贝格公式的逐步计算和加速，在不增加计算量的基础上显著提高了精度。其一般递推公式和加速原理使得计算结果能够快速收敛到准确值，体现了外推算法的高效性。与其他方法相比，Romberg算法在处理此类积分问题时具有明显优势，尤其适用于对精度要求较高的科学计算和工程应用中的积分计算。
4. 在求函数$f(x)=e^{x}$在$x = 1$处的导数值时，中点公式随着$h$的减小，结果逐渐接近准确值$e \approx 2.71828$，但收敛速度较慢。中点加速公式$G_{1}(h)$和$G_{2}(h)$通过对中点公式的改进，收敛速度明显加快，且$G_{2}(h)$比$G_{1}(h)$收敛更快、精度更高。这表明加速公式在数值微分中能够有效地提高计算精度，减少计算误差，在实际需要计算函数导数近似值的场景中具有重要应用价值，例如在优化算法、数值求解微分方程等方面。同时也提醒在使用数值微分方法时，要根据具体需求选择合适的公式，并注意$h$值的选择对结果的影响，以平衡截断误差和舍入误差，获得较为准确的结果。
