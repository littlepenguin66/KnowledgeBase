# 第三章 Z变换

### 第三章 $\mathcal Z$变换及其性质

1. **引言**

    * 离散时间信号与系统分析有时域和频域分析，$\mathcal Z$变换在频域分析中起关键作用，能将差分方程转化为代数方程，是重要数学工具。
2. **$Z$**​**变换**

    * **定义与收敛域**：$X(z)=\sum_{n = -\infty}^{\infty}x(n)z^{-n}$，$z$为复数变量，收敛域是使$Z$变换收敛的$z$值集合，依据级数收敛条件确定，与序列形式有关。
    * **不同序列的**​**$Z$**​**变换及收敛域**

      * **有限长序列**：在有限区间有非零值，收敛域至少是除$z = 0$及$z=\infty$外的开域，特殊情况可扩大。
      * **右边序列**：$n\geq n_1$时有非零值，收敛域为$R_{x - } <\vert z\vert <\infty$。
      * **因果序列**：$n\geq0$时有非零值，是重要右边序列，收敛域可包括$\vert z\vert=\infty$。
      * **左边序列**：$n\leq n_2$时有非零值，收敛域为$0 <\vert z\vert < R_{x + }$，$n_2\leq0$时包括$z = 0$。
      * **双边序列**：可看成右边和左边序列之和，收敛域为环状区域$R_{x - } <\vert z\vert < R_{x + }$（若$R_{x - } < R_{x + }$）。
    * **$Z$**​**变换收敛域的性质**

      * 是中心在原点的圆或圆环。
      * 内不能包含极点。
      * 有限长序列收敛域为整个$z$平面（$z = 0$或$z=\infty$可能除外）。
      * 右边序列收敛域从最大幅度极点向外延伸至$z=\infty$。
      * 左边序列收敛域从最小非零幅度极点向内延伸至$z = 0$。
      * 双边序列收敛域为圆环，由极点确定边界，且内无极点。
      * 必须是连通区域。
      * 当收敛域包括单位圆时，序列的傅里叶变换绝对收敛。
3. $\mathcal Z$​**反变换**

    * **定义与方法**：从$\mathcal Z$变换$X(z)$还原出原序列$x(n)$，方法有观察法、围线积分法、部分分式法、幂级数展开法。
    * **观察法**：根据熟悉的变换对直接写出反变换，利用常见变换对和$Z$变换表，将给定$Z$变换表示成可直接写出反变换的形式。
    * **围线积分法**

      * 基于柯西积分定理，$x(n)=\frac{1}{2\pi j}\oint_{C^{+}}X(z)z^{n - 1}dz$（$C^{+}$在收敛域内环绕原点），可利用留数定理计算，根据极点分布和阶数选择合适公式计算留数。
    * **部分分式法**

      * 将$X(z)$用部分分式展开，根据极点情况确定展开形式，求系数后利用$Z$变换表求反变换，注意区分不同序列极点及收敛域。
    * **幂级数展开法**

      * 将$X(z)$在收敛域内展开成幂级数，系数即为序列值，根据收敛域判断序列性质确定展开方式（$z$的正幂或负幂级数）。
4. **$Z$**​**变换性质**

    * **线性性**：$ax(n)+by(n)\leftrightarrow aX(z)+bY(z)$，收敛域为相加序列收敛域公共部分，零点极点抵消时可能扩大。
    * **时移性**：$x(n - n_0)\leftrightarrow z^{-n_0}X(z)$，收敛域一般不变，单边序列在$z = 0$或$z=\infty$可能例外。
    * **指数序列相乘性**：$a^nx(n)\leftrightarrow X(\frac{z}{a})$，$Z$变换零极点位置改变，$a$为正实数时$z$平面缩放，$a$为复数且模为$1$时旋转，$a$为任意复数时幅度伸缩和角度旋转。
    * **$X(z)$**​**的微分**：$nx(n)\leftrightarrow -z\frac{d}{dz}X(z)$，时域线性加权等效于$Z$变换域求导后乘以$(-z)$，可递推求$n^mx(n)$的$Z$变换。
    * **复序列的共轭**：$x^*(n)\leftrightarrow X^*(z^*)$。
    * **复序列共轭的翻褶**：$x^*(-n)\leftrightarrow X^*(\frac{1}{z^*})$，实序列或不取共轭时$x(-n)\leftrightarrow X(\frac{1}{z})$。
    * **序列的卷积**：$y(n)=x(n)*h(n)$时$Y(z)=X(z)H(z)$，收敛域为$X(z)$和$H(z)$收敛域公共部分，极点零点抵消时可能扩大。
    * **序列相乘**：$y(n)=x(n)h(n)$时$Y(z)=\frac{1}{2\pi j}\oint_{C^{+}}X(\frac{z}{v})H(v)v^{-1}dv$，$C^{+}$在特定收敛域内，$X(z)$和$H(z)$位置可互换，有类似卷积积分的周期卷积形式。
    * **初值定理**：因果序列$x(0)=\lim_{z\rightarrow\infty}X(z)$。
    * **终值定理**：因果序列且$X(z)$极点满足条件时$\lim_{n\rightarrow\infty}x(n)=\lim_{z\rightarrow1}[(z - 1)X(z)]$。
    * **帕塞瓦尔定理**：满足条件时$\sum_{n = -\infty}^{\infty}x(n)h^*(n)=\frac{1}{2\pi j}\oint_{C^{+}}X(v)H^*(\frac{1}{v^*})v^{-1}dv$，$h(n)=x(n)$时有相应能量计算公式，说明时域和频域能量计算一致。

### 课堂测验讲解

1. **习题3 - 1**

    * (1) $x(n)=(\frac{1}{3})^nu(-n)$，$Z$变换$X(z)=\sum_{n = -\infty}^{0}(\frac{1}{3})^nz^{-n}=\sum_{n = 0}^{\infty}3^nz^n=\frac{1}{1 - 3z}$（$\vert z\vert <\frac{1}{3}$），极点为$z=\frac{1}{3}$，收敛域为$\vert z\vert <\frac{1}{3}$，零极点图：在$z=\frac{1}{3}$处有极点。
    * (2) $x(n)=(\frac{1}{3})^n\cos(n\omega_0)u(n)$，利用欧拉公式$\cos(n\omega_0)=\frac{e^{jn\omega_0}+e^{-jn\omega_0}}{2}$，则$x(n)=\frac{1}{2}[(\frac{1}{3}e^{j\omega_0})^nu(n)+(\frac{1}{3}e^{-j\omega_0})^nu(n)]$。$Z$变换$X(z)=\frac{1}{2}[\frac{1}{1 - \frac{1}{3}e^{j\omega_0}z^{-1}}+\frac{1}{1 - \frac{1}{3}e^{-j\omega_0}z^{-1}}]$（$\vert z\vert >\frac{1}{3}$），极点为$z=\frac{1}{3}e^{\pm j\omega_0}$，收敛域为$\vert z\vert >\frac{1}{3}$，零极点图：在$z=\frac{1}{3}e^{\pm j\omega_0}$处有极点。
    * (3) $x(n)= - (\frac{1}{2})^nu(-n - 1)$，$Z$变换$X(z)=-\sum_{n = -\infty}^{-1}(\frac{1}{2})^nz^{-n}=-\sum_{n = 1}^{\infty}2^nz^n=\frac{1}{1 - 2z}$（$\vert z\vert <\frac{1}{2}$），极点为$z=\frac{1}{2}$，收敛域为$\vert z\vert <\frac{1}{2}$，零极点图：在$z=\frac{1}{2}$处有极点。
    * (4) $x(n)=(\frac{1}{2})^nu(n + 2)+(3)^nu(-n - 1)$，$Z$变换$X(z)=\sum_{n = -2}^{\infty}(\frac{1}{2})^nz^{-n}+\sum_{n = -\infty}^{-1}3^nz^{-n}=z^2\sum_{n = 0}^{\infty}(\frac{1}{2})^nz^{-n}-\sum_{n = 1}^{\infty}(\frac{1}{3})^nz^n=\frac{z^2}{1 - \frac{1}{2}z^{-1}}-\frac{\frac{1}{3}z}{1 - \frac{1}{3}z}$（$\frac{1}{3} <\vert z\vert < 2$），极点为$z=\frac{1}{2}$和$z = 3$，收敛域为$\frac{1}{3} <\vert z\vert < 2$，零极点图：在$z=\frac{1}{2}$和$z = 3$处有极点。
    * (5) $x(n)=a^{\vert n\vert},\vert a\vert < 1$，$x(n)=a^nu(n)+\sum_{n = -\infty}^{-1}a^{-n}z^{-n}=a^nu(n)+\sum_{n = 1}^{\infty}(az)^n=\frac{1}{1 - az^{-1}}+\frac{az}{1 - az}$（$\vert a\vert <\vert z\vert <\frac{1}{\vert a\vert}$），极点为$z = a$和$z=\frac{1}{a}$，收敛域为$\vert a\vert <\vert z\vert <\frac{1}{\vert a\vert}$，零极点图：在$z = a$和$z=\frac{1}{a}$处有极点。
    * (6) $x(n)=(\frac{1}{2})^nu(n)$，$Z$变换$X(z)=\frac{1}{1 - \frac{1}{2}z^{-1}}$（$\vert z\vert >\frac{1}{2}$），极点为$z=\frac{1}{2}$，收敛域为$\vert z\vert >\frac{1}{2}$，零极点图：在$z=\frac{1}{2}$处有极点。
    * (7) $x(n)=\frac{1}{n},n\geq1$，$Z$变换$X(z)=\sum_{n = 1}^{\infty}\frac{1}{n}z^{-n}$，此为对数函数的幂级数展开形式，收敛域为$\vert z\vert > 1$，极点情况较复杂（可根据幂级数性质分析，此处不详细展开），零极点图略（极点分布不简单表示）。
    * (8) $x(n)=Ar^n\cos(\omega_0n+\Phi)u(n)$，类似(2)中利用欧拉公式展开，$x(n)=\frac{Ar^n}{2}[e^{j(\omega_0n+\Phi)}u(n)+e^{-j(\omega_0n+\Phi)}u(n)]$，$Z$变换$X(z)=\frac{Ar^n}{2}[\frac{e^{j\Phi}}{1 - re^{j\omega_0}z^{-1}}+\frac{e^{-j\Phi}}{1 - re^{-j\omega_0}z^{-1}}]$（$\vert z\vert > r$），极点为$z = re^{\pm j\omega_0}$，收敛域为$\vert z\vert > r$，零极点图：在$z = re^{\pm j\omega_0}$处有极点。
2. **习题3 - 2**

    * (1) $X(z)=\frac{1 - \frac{1}{2}z^{-1}}{1 - \frac{1}{4}z^{-2}}=\frac{1 - \frac{1}{2}z^{-1}}{(1 - \frac{1}{2}z^{-1})(1 + \frac{1}{2}z^{-1})}=\frac{1}{1 + \frac{1}{2}z^{-1}}$（$\vert z\vert >\frac{1}{2}$）。

      * 长除法：将分子分母按$z^{-1}$升幂排列做长除，$1 + \frac{1}{2}z^{-1}\overline{)1 - \frac{1}{2}z^{-1}}$，得到$x(n)=(-\frac{1}{2})^nu(n)$。
      * 留数定理：设$G(z)=X(z)z^{n - 1}=\frac{z^{n - 1}}{1 + \frac{1}{2}z^{-1}}=\frac{z^n}{z+\frac{1}{2}}$，当$n\geq0$时，$G(z)$在$z = -\frac{1}{2}$有单极点，$x(n)=\text{Res}[G(z)]_{z = -\frac{1}{2}}=(-\frac{1}{2})^n$；当$n < 0$时，$G(z)$在$z = -\frac{1}{2}$有高阶极点，计算较复杂（此处略），但根据收敛域$\vert z\vert >\frac{1}{2}$可知$n < 0$时$x(n)=0$，所以$x(n)=(-\frac{1}{2})^nu(n)$。
      * 部分分式法：$X(z)=\frac{1}{1 + \frac{1}{2}z^{-1}}$，对比$\frac{1}{1 - az^{-1}}\leftrightarrow a^nu(n)$（$\vert z\vert >\vert a\vert$），可得$x(n)=(-\frac{1}{2})^nu(n)$。
      * $Z$变换性质：$X(z)=\frac{1 - \frac{1}{2}z^{-1}}{1 - \frac{1}{4}z^{-2}}=\frac{1 - \frac{1}{2}z^{-1}}{(1 - \frac{1}{2}z^{-1})(1 + \frac{1}{2}z^{-1})}=\frac{1}{1 + \frac{1}{2}z^{-1}}$，由$u(n)$的$Z$变换$\frac{1}{1 - z^{-1}}$（$\vert z\vert > 1$），$X(z)$相当于$u(n)$的$Z$变换中$z^{-1}$换成$-\frac{1}{2}z^{-1}$，根据指数序列相乘性，可得$x(n)=(-\frac{1}{2})^nu(n)$。
    * (2) $X(z)=\lg(1+\frac{a}{z})$（$\vert z\vert >\vert a\vert$）。

      * 幂级数展开法：已知$\lg(1+x)=\sum_{n = 1}^{\infty}\frac{(-1)^{n + 1}x^n}{n}$（$\vert x\vert < 1$），这里$x=\frac{a}{z}$，则$X(z)=\sum_{n = 1}^{\infty}\frac{(-1)^{n + 1}a^n}{n}z^{-n}$，所以$x(n)=\frac{(-1)^{n + 1}a^n}{n}u(n - 1)$。
    * (3) $X(z)=\frac{4 - \frac{7}{4}z^{-1}+\frac{1}{4}z^{-2}}{1 - \frac{3}{4}z^{-1}+\frac{1}{8}z^{-2}}$（$\vert z\vert >\frac{1}{2}$）。

      * 先将分子分母因式分解（计算过程略），然后用部分分式法展开（假设展开后为$X(z)=A+\frac{B}{1 - cz^{-1}}+\frac{D}{1 - ez^{-1}}$形式，具体计算$A$、$B$、$D$、$c$、$e$的值过程略），得到$X(z)$的展开式。再根据$Z$变换表，分别求出各项的反变换，最后相加得到$x(n)$（具体序列形式根据计算结果确定，此处略）。
    * (4) $X(z)=\frac{1 - 2z^{-1}}{1 - \frac{1}{4}z^{-1}}$（$\vert z\vert <\frac{1}{4}$）。

      * 长除法：将分子分母按$z$的升幂排列做长除（计算过程略），得到$x(n)$的表达式（根据计算结果确定具体形式，此处略）。
      * 留数定理：设$G(z)=X(z)z^{n - 1}=\frac{(1 - 2z^{-1})z^{n - 1}}{1 - \frac{1}{4}z^{-1}}=\frac{z^n - 2z^{n - 1}}{z-\frac{1}{4}}$，当$n\leq - 1$时，$G(z)$在$z=\frac{1}{4}$有$(-n)$阶极点，计算留数（过程略）得到$x(n)$；当$n\geq0$时，$G(z)$在$z=\frac{1}{4}$有单极点，计算留数（过程略），根据收敛域可知$n\geq0$时$x(n)=0$，最终得到$x(n)$的表达式（根据计算结果确定具体形式，此处略）。
3. **习题3 - 3**

    * 已知$y(n)=\sum_{k = 0}^{\infty}x(n - kN)$，$X(z)=\sum_{n = 0}^{N - 1}x(n)z^{-n}$。
    * 则$Y(z)=\sum_{n = 0}^{\infty}y(n)z^{-n}=\sum_{n = 0}^{\infty}\sum_{k = 0}^{\infty}x(n - kN)z^{-n}$。
    * 令$m = n - kN$，则$n = m + kN$，当$k = 0$时，$m = n$；当$k = 1$时，$m = n - N$；当$k = 2$时，$m = n - 2N$等。
    * 所以$Y(z)=\sum_{m = 0}^{N - 1}x(m)\sum_{k = 0}^{\infty}z^{-(m + kN)}=\sum_{m = 0}^{N - 1}x(m)z^{-m}\sum_{k = 0}^{\infty}(z^{-N})^k$。
    * 因为$\sum_{k = 0}^{\infty}(z^{-N})^k=\frac{1}{1 - z^{-N}}$（$\vert z\vert > 1$），所以$Y(z)=\frac{1}{1 - z^{-N}}\sum_{m = 0}^{N - 1}x(m)z^{-m}=\frac{X(z)}{1 - z^{-N}}$（$\vert z\vert > 1$）。
4. **习题3 - 4**

    * 已知$h(n)=\begin{cases}(\frac{1}{2})^n, & 0\leq n\leq2 \\ 0, & \text{其他}n\end{cases}$，$x(n)=\delta(n)+\delta(n - 1)+4\delta(n - 2)$。
    * 方法一：直接卷积法

      * $y(n)=x(n)*h(n)=\sum_{m = -\infty}^{\infty}x(m)h(n - m)$。
      * 当$n < 0$时，$h(n - m)$与$x(m)$无交叠，$y(n)=0$。
      * 当$n = 0$时，$y(0)=x(0)h(0)=1\times1 = 1$。
      * 当$n = 1$时，$y(1)=x(0)h(1)+x(1)h(0)=1\times\frac{1}{2}+1\times1=\frac{3}{2}$。
      * 当$n = 2$时，$y(2)=x(0)h(2)+x(1)h(1)+x(2)h(0)=1\times(\frac{1}{2})^2+1\times\frac{1}{2}+4\times1=\frac{17}{4}$。
      * 当$n = 3$时，$y(3)=x(1)h(2)+x(2)h(1)=1\times(\frac{1}{2})^2+4\times\frac{1}{2}=\frac{9}{4}$。
      * 当$n = 4$时，$y(4)=x(2)h(2)=4\times(\frac{1}{2})^2 = 1$。
      * 当$n\geq5$时，$h(n - m)$与$x(m)$无交叠，$y(n)=0$。
      * 所以$y(n)=\begin{cases}1, & n = 0 \\ \frac{3}{2}, & n = 1 \\ \frac{17}{4}, & n = 2 \\ \frac{9}{4}, & n = 3 \\ 1, & n = 4 \\ 0, & n\geq5\end{cases}$。
    * 方法二：$Z$变换法

      * 先求$h(n)$的$Z$变换$H(z)=\sum_{n = 0}^{2}(\frac{1}{2})^nz^{-n}=1+\frac{1}{2}z^{-1}+\frac{1}{4}z^{-2}$（$\vert z\vert > 0$）。
      * $x(n)$的$Z$变换$X(z)=1 + z^{-1}+4z^{-2}$（$\vert z\vert > 0$）。
      * 则$Y(z)=X(z)H(z)=(1 + z^{-1}+4z^{-2})(1+\frac{1}{2}z^{-1}+\frac{1}{4}z^{-2})$。
      * 展开$Y(z)=1+\frac{3}{2}z^{-1}+\frac{17}{4}z^{-2}+\frac{9}{4}z^{-3}+z^{-4}$。
      * 求$Y(z)$的反变换得$y(n)=\begin{cases}1, & n = 0 \\ \frac{3}{2}, & n = 1 \\ \frac{17}{4}, & n = 2 \\ \frac{9}{4}, & n = 3 \\ 1, & n = 4 \\ 0, & n\geq5\end{cases}$。
5. **习题3 - 5**

    * 直接卷积法：

      * $y(n)=x(n)*h(n)=\sum_{m = -\infty}^{\infty}x(m)h(n - m)$。
      * 因为$x(n)=a^nu(n)$，$h(n)=b^nR_N(n)$。
      * 当$n < 0$时，$h(n - m)$与$x(m)$无交叠，$y(n)=0$。
      * 当$0\leq n\leq N - 1$时，$y(n)=\sum_{m = 0}^{n}a^mb^{n - m}=b^n\sum_{m = 0}^{n}(a/b)^m=\frac{b^n(1-(a/b)^{n + 1})}{1 - a/b}$。
      * 当$n\geq N$时，$y(n)=\sum_{m = 0}^{N - 1}a^mb^{n - m}=b^n\sum_{m = 0}^{N - 1}(a/b)^m=\frac{b^n(1-(a/b)^N)}{1 - a/b}$。
    * $Z$变换法：

      * $x(n)$的$Z$变换$X(z)=\frac{1}{1 - az^{-1}}$（$\vert z\vert >\vert a\vert$）。
      * $h(n)$的$Z$变换$H(z)=\frac{1 - b^Nz^{-N}}{1 - bz^{-1}}$（$\vert z\vert > 0$）。
      * 则$Y(z)=X(z)H(z)=\frac{1 - b^Nz^{-N}}{(1 - az^{-1})(1 - bz^{-1})}$。
      * 用部分分式法将$Y(z)$展开（计算过程略），再求反变换得到$y(n)$（结果与直接卷积法一致，具体形式根据展开和计算结果确定，此处略）。
6. **思考题3 - 6**

    * 拉氏变换与$Z$变换的关系：

      * 拉氏变换用于连续时间信号与系统，$Z$变换用于离散时间信号与系统。
      * 对于连续时间信号$x(t)$，其拉氏变换为$X(s)=\int_{-\infty}^{\infty}x(t)e^{-st}dt$；对于离散时间信号$x(n)$，其$Z$变换为$X(z)=\sum_{n = -\infty}^{\infty}x(n)z^{-n}$。
      * 从采样角度看，如果对连续信号$x(t)$以采样间隔$T$进行采样得到离散信号$x(n)=x(nT)$，当$s = \frac{1}{T}\ln z$时，$Z$变换可看成是拉氏变换在$s$平面虚轴上的采样值（在一定条件下）。例如，对于因果连续信号$x(t)$，其拉氏变换$X(s)$的极点都在$s$平面的左半平面，当对其采样得到离散信号$x(n)$后，$x(n)$的$Z$变换$X(z)$的极点都在$z$平面的单位圆内（在满足采样定理等条件下），且$X(z)$与$X(s)$在某种程度上存在对应关系，这种关系有助于在连续和离散系统分析之间进行转换和理解。
7. **思考题3 - 7**

    * 在序列的$Z$变换形式中，极点的意义：

      * 极点决定了$Z$变换的收敛域边界，收敛域是以极点为边界的圆或圆环（或其一部分）。例如，对于右边序列，收敛域是从最大幅度极点向外延伸；对于左边序列，收敛域是从最小非零幅度极点向内延伸。
      * 极点影响序列的性质，如因果性和稳定性。对于因果序列，其$Z$变换在$\vert z\vert=\infty$处收敛，即不存在$\vert z\vert=\infty$处的极点；对于稳定序列，其$Z$变换的单位圆必须在收敛域内，即极点不能在单位圆上（对于有限$z$值的极点），若极点在单位圆外，则序列可能是不稳定的。
      * 极点与序列的时域特性相关，通过极点位置可以大致了解序列的变化趋势。例如，实极点在单位圆内时，对应序列是衰减的；实极点在单位圆外时，对应序列是增长的；共轭复极点在单位圆内时，对应序列是振荡衰减的；共轭复极点在单位圆上时，对应序列是等幅振荡的；共轭复极点在单位圆外时，对应序列是振荡增长的。同时，极点的幅度和相位等信息也能反映序列的频率特性等信息，在系统分析和设计中，极点的位置对系统的性能有着重要影响，如滤波器的设计中，通过合理配置极点位置来实现所需的滤波特性。
