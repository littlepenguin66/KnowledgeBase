# 第四章 连续时间信号采样与量化误差

[第四章 连续时间信号采样与量化误差（Part2）](第四章%20连续时间信号采样与量化误差（Part2）.md)

### 主要内容

1. **连续时间信号的采样**

    * **周期采样**：通过按一定时间间隔$T$进行采样，将连续时间信号$x_c(t)$转换为离散时间信号$x_s(t)$，采样频率$f_s = 1/T$，模拟角频率$\Omega_s = 2\pi f_s$，理想采样可看成电子开关，实际采样中开关闭合时间有延续。
    * **理想采样**：当采样脉冲宽度$\tau \to 0$时为理想采样，采样信号$x_s(t) = x_c(t) \cdot \delta_T(t)$，其中$\delta_T(t)=\sum_{m = -\infty}^{\infty}\delta(t - mT)$，理想采样输出为$x_s(t)=\sum_{m = -\infty}^{\infty}x_c(mT)\delta(t - mT)$。
    * **采样信号的频域表示**：连续时间信号经理想采样后，频谱变为以采样频率$\Omega_s$为周期的函数，$X_s(j\Omega)=\frac{1}{T}\sum_{k = -\infty}^{\infty}X_c[j(\Omega-\frac{2\pi}{T}k)]$，若原始信号是限带信号且满足$\Omega_s > 2\Omega_h$（奈奎斯特采样定理），则可避免频谱混叠，$\Omega_h$为信号最高频率，$\Omega_s/2$为折叠频率。
    * **被采样信号的重构**：满足奈奎斯特采样定理时，采样信号通过理想低通滤波器（截止频率为$\Omega_s/2$）可重构原始信号，采样内插公式为$y_c(t)=\sum_{m = -\infty}^{\infty}x_c(mT)\frac{\sin\frac{\pi}{T}(t - mT)}{\frac{\pi}{T}(t - mT)}$，内插函数在采样点值为1，其他采样点为0，保证采样点信号值不变，采样点间信号由内插函数波形延伸叠加构成。
    * **实际采样讨论**：实际采样脉冲为具有一定延续时间$\tau$的矩形周期脉冲$p(t)$，其频谱也是连续时间信号频谱的周期延拓，只要满足奈奎斯特采样定理就不会产生混叠失真，与理想采样不同的是频谱分量幅度有变化，包络随频率增加逐渐下降，但不影响原始信号恢复，实际采样信号重构时幅度有所缩减，奈奎斯特采样定理仍适用。
2. **量化误差分析**

    * **量化原理**

      * **消除混叠的预滤波**：为避免混叠，在C/D转换器前用低通滤波器（抗混叠滤波器）对连续时间信号滤波，使信号低于奈奎斯特频率，减少处理运算量。
      * **模拟到数字（A/D）转换**：A/D转换器将连续时间信号转换为有限精度的数字信号，包括采样与保持环节（如零阶保持），其输出为量化样本，量化器将输入样本转换为有限集合值中的一个，量化电平可为均匀或非均匀间隔，量化阶通常均匀，量化电平数一般为2的幂，实际量化器电平数较大，相邻电平差小，量化器输出的量化样本编码有多种方案，如补偿二进制编码、2的补码等，2的补码在数字信号处理中应用广泛，其最高有效位为符号位，其余位表示二进制分数，量化器量化阶$\Delta=\frac{X_m}{2^B}$，$X_m$为A/D转换器满幅度值，码字与量化样本关系为$\hat{x}(n)=X_m\hat{x}_B(n)$。
    * **量化误差分析**

      * 量化误差$e(n)=\hat{x}(n)-x(n)$，在一定条件下，如$(-X_m-\frac{1}{2}\Delta) < x(n) \leq (X_m-\frac{1}{2}\Delta)$时，量化误差满足$-\frac{1}{2}\Delta < e(n) \leq \frac{1}{2}\Delta$，超出此范围样本会箝位。
      * 量化器可简化为加性噪声模型，在信号复杂、量化阶数小等条件下，量化误差可假设为平稳随机过程，满足误差序列与输入序列不相关、误差过程随机变量不相关、误差概率分布在量化误差范围内均匀分布等假设，此时量化噪声可视为均匀分布的白噪声序列，均值为零，方差$\sigma_e^2=\frac{1}{12}\Delta^2=\frac{1}{12}\cdot 2^{-2B}X_m^2$。
      * 信噪比$SNR = 10\lg\frac{\sigma_x^2}{\sigma_e^2}=6.02B + 10.8 - 20\lg\frac{X_m}{\sigma_x}$，量化样本字长每增加一位，信噪比近似提高$6dB$，信号幅度与A/D转换器满幅度值匹配很重要，如对于语音和音乐信号，可设置滤波器和放大器增益使$\sigma_x = X_m/4$，此时$SNR\approx 6B - 1.25dB$。

### 课堂测验讲解

1. **习题4 - 1**

    * 已知离散时间序列$x(n)=\cos(\frac{3\pi}{20}n)$，采样频率$f_s = 8kHz$，则采样间隔$T = 1/f_s = 1/8000s$。
    * 设连续时间信号为$x_c(t)=\cos(\Omega_0t)$，则$x(n)=x_c(nT)=\cos(\Omega_0nT)=\cos(\frac{3\pi}{20}n)$，即$\Omega_0T = \frac{3\pi}{20}+2k\pi$（$k$为整数）。
    * 解得$\Omega_0=\frac{3\pi}{20T}+2k\pi/T=\frac{3\pi}{20}\times8000 + 2k\pi\times8000 = 1200\pi + 16000k\pi$。
    * 当$k = 0$时，$x_{c1}(t)=\cos(1200\pi t)$；当$k = -1$时，$x_{c2}(t)=\cos(1200\pi t - 16000\pi t)=\cos(-14800\pi t)=\cos(14800\pi t)$。
    * 所以两个不同的连续时间信号可以是$x_{c1}(t)=\cos(1200\pi t)$和$x_{c2}(t)=\cos(14800\pi t)$。
2. **习题4 - 2**

    * 已知$x_c(t)$的奈奎斯特率为$\Omega_s$，即$x_c(t)$最高频率为$\Omega_s/2$。
    * 对于$x_c^2(2t)$，根据信号时间尺度变换性质，$x_c(2t)$的最高频率变为$2\times\frac{\Omega_s}{2}=\Omega_s$，则$x_c^2(2t)$的最高频率为$2\Omega_s$，其奈奎斯特率为$4\Omega_s$。
    * 对于$x_c^2(t/3)$，$x_c(t/3)$的最高频率变为$\frac{1}{3}\times\frac{\Omega_s}{2}=\frac{\Omega_s}{6}$，所以$x_c^2(t/3)$的最高频率为$\frac{\Omega_s}{3}$，其奈奎斯特率为$\frac{2\Omega_s}{3}$。
    * 对于$x(t)*x(t)$，根据卷积定理，其频谱是$X(j\Omega)^2$，最高频率不变，仍为$\Omega_s/2$，所以奈奎斯特率为$\Omega_s$。
3. **习题4 - 3**

    * 采样间隔$T = 1ms = 0.001s$，根据奈奎斯特采样定理，要使连续时间信号能从采样信号中不失真恢复，采样频率$f_s$需满足$f_s > 2f_h$，即$f_h < f_s/2$。
    * 已知$f_s = 1/T = 1/0.001 = 1000Hz$，所以$f_h < 1000/2 = 500Hz$，即$X_c(j\Omega)$（或$X_c(f)$）的最高频率为$500Hz$。
4. **习题4 - 4**

    * $x_c(t)$带限是$8kHz$，则其奈奎斯特率$f_s = 2\times8000 = 16000Hz = 16kHz$。
    * 对于$x_c(t)\cos(2\pi\cdot1000t)$，$\cos(2\pi\cdot1000t)$的频率为$1000Hz$，根据两个信号相乘时傅氏变换为卷积关系，其奈奎斯特率为$2\times8000 + 2\times1000 = 16000 + 2000 = 18000Hz = 18kHz$。
5. **习题4 - 5**

    * 已知信号与量化噪声比最小为$90dB$，即$SNR = 90dB$，量化器量程为$-3\sigma_x$到$3\sigma_x$，则$X_m = 3\sigma_x$。
    * 由$SNR = 6.02B + 10.8 - 20\lg\frac{X_m}{\sigma_x}$，将$X_m = 3\sigma_x$代入可得$SNR = 6.02B + 10.8 - 20\lg3$。
    * 当$SNR = 90dB$时，$90 = 6.02B + 10.8 - 20\lg3$，解方程可得$B=\frac{90 - 10.8 + 20\lg3}{6.02}\approx15$，所以$B + 1 = 16$位，即A/D转换器需要16位。
6. **思考题4 - 6**

    * （1）已知实值带通信号$x_c(t)$，$f_1 = 8kHz$，$f_2 = 10kHz$，采样频率$f_s = 4kHz$。
    * 根据离散傅氏变换性质，离散傅氏变换后的频谱会以采样频率$f_s$为周期进行周期延拓，且会发生混叠。
    * 原信号频谱在$f_1$到$f_2$之间，以$f_s = 4kHz$采样后，会将高频部分折叠到低频部分，示意图可根据周期延拓和混叠的概念进行绘制，例如在$0$到$f_s/2 = 2kHz$区间内，会出现原信号在$f_1$到$f_2$之间的频谱以及混叠后的频谱部分。
    * （2）带通信号带宽$B = f_2 - f_1$，中心频率$f_c=(f_2 + f_1)/2$，若$f_c > B/2$且$f_2$是带宽$B$的整数倍，设$f_2 = kB$（$k$为整数）。
    * 采样频率$f_s = 2B$，则采样间隔$T = 1/f_s = 1/(2B)$。
    * 对于带通信号$x_c(t)$，其频谱$X_c(f)$在$f_1$到$f_2$之间，经过采样后，根据采样定理的推导过程，其频谱会以$f_s$为周期延拓。
    * 由于$f_2 = kB$，$f_s = 2B$，可以证明在这种情况下，延拓后的频谱不会发生混叠（具体证明可通过分析频谱的周期延拓规律以及带通信号的频率范围等进行详细推导）。
    * （3）当$f_2$不是带宽$B$的整数倍时，同样根据采样后频谱的周期延拓规律进行分析，会发现此时会发生混叠（具体混叠情况可通过举例或详细的频谱分析来说明）。
7. **思考题4 - 7**

    * 理想低通滤波器的冲激响应$h(t)=\frac{\sin\frac{\pi}{T}t}{\frac{\pi}{T}t}$，其在$t < 0$时不为零。
    * 对于因果系统，冲激响应$h(t)$在$t < 0$时必须为零，而理想低通滤波器不满足这一条件，所以它是非因果系统。
    * 在物理上，由于无法预知未来的输入信号，无法实现一个冲激响应在$t < 0$时不为零的系统，所以理想低通滤波器是物理上不可实现的系统。

‍

【例4-7】对一幅图像以最小信号量化噪声比为80dB的进行采样。与许多其他信 号不同,图像采样是非负的。假设采样装置是校准好的,从而采样图像强度落在从0到1的区间。需要多少位才能达到所需的信号量化噪声比。

*  解:对于幅值落在区间 $[-X_{m}, X_{m}]$ 的双极信号,其信号与量化噪声比是 $SNR=6.02 B+10.8-20 lg \frac{X_{m}}{\sigma_{x}}$ 而在区间[0,1]内的非负信号,若我们设 $X_{m}=0.5$ ,则其信号与量化噪声比等效于双极性情况,如果我们假设图像的强度均匀地分布在[0,1]上, $\sigma_{x}^{2}=1 / 12$ ,因此  
  $SNR=6.02 B+10.8-20 lg \frac{X_{m}}{\sigma_{x}}=6.02 B+10.8-20 lg \frac{\sqrt{12}}{2}=6.02 B+6.03$ 对于80 dB的信号与量化噪声比来说,需要 $B=\frac{80-6.03}{6.02}=12.29$ 或 $B+1=14$ 位。

1. **均匀分布的方差计算**

    对于在区间$[0,1]$上均匀分布的随机变量（这里假设图像强度均匀分布在$[0,1]$上），其概率密度函数$f(x)=1$（$0 \leq x \leq 1$），$f(x)=0$（其他）。

    * 方差$\sigma_{x}^{2}$的计算公式为$\sigma_{x}^{2}=E[(x - E[x])^{2}]$，其中$E[x]$是期望。
    * 对于均匀分布，期望$E[x]=\frac{0 + 1}{2}=0.5$。
    * 计算方差$\sigma_{x}^{2}=\int_{0}^{1}(x - 0.5)^{2} \times 1dx=\int_{0}^{1}(x^{2}-x + 0.25)dx$。
    * 对其积分可得$\left[\frac{x^{3}}{3}-\frac{x^{2}}{2}+0.25x\right]_{0}^{1}=\frac{1}{3}-\frac{1}{2}+0.25=\frac{1}{12}$。
2. **在本题中的意义**

    * 在计算图像信号（假设其强度均匀分布在$[0,1]$）与量化噪声比时，需要用到信号的方差$\sigma_{x}^{2}$。通过上述计算得到$\sigma_{x}^{2}=\frac{1}{12}$，将其代入信号与量化噪声比公式$SNR = 6.02B + 10.8 - 20\lg\frac{X_{m}}{\sigma_{x}}$（这里设$X_{m}=0.5$，因为对于区间$[0,1]$内非负信号，设$X_{m}=0.5$使其信号与量化噪声比等效于双极性情况），就可以根据要求的信噪比计算所需的量化器位数等相关参数。
    * 例如在例4 - 7中，已知希望的信噪比为$80dB$，通过该公式计算出需要$14$位量化（$B + 1 = 14$，则$B = 13$），这里准确的$\sigma_{x}^{2}=\frac{1}{12}$对于计算结果是很重要的。如果方差计算错误，会导致信噪比计算错误，进而影响对量化器位数等的判断。

‍

信号与晕化噪声比(SNR)的公式为：

$$
SNR=10\lg\frac{\sigma_x^2}{\sigma_e^2}
$$

进一步推导可得：

$$
SNR=10\lg\frac{12\cdot2^{2B}\sigma_x^2}{X_m^2}=6.02B+10.8-20\lg\frac{X_m}{\sigma_x}
$$

如果希望信号与量化噪声比最小为 90 dB，A/D 转换器需要多少位？假设 $( x_a(t) )$是高斯型的且方差为 $( \sigma_x^2 )$，量化器的量程为 $(-3\sigma)$ 到$(3\sigma)$，即 $( X_m = 3\sigma )$（对于$( X_m )$ 的这个值，大约有 1/1000 的采样会超出量化器量程)。

## 💡 解答

首先，我们来推导信号与量化噪声比$（SQNR）$的表达式。

量化噪声功率可以表示为$( N_q = \frac{\Delta^2}{12} )$，其中 $( \Delta )$ 是量化间隔。

假设 $A/D$转换器是均匀量化的，量化间隔 $( \Delta = \frac{2X_m}{2^B} )$，其中 \( B \) 是 A/D 转换器的位数，$( X_m = 3\sigma )$。

则量化噪声功率 $( N_q = \frac{(2X_m)^2}{12 \times 2{2B}} = \frac{(6\sigma)^2}{12 \times 2{2B}} = \frac{3\sigma^2}{2{2B}} )$。

信号功率为$( S = \sigma_x^2 = \sigma^2 )$。

信号与量化噪声比 SQNR 为：  
​$SQNR = 10\log_{10}\frac{S}{N_q} = 10\log_{10}\frac{\sigma2}{\frac{3\sigma2}{2^{2B}}} = 10\log_{10}\frac{2^{2B}}{3}$  

已知 SQNR 最小为 90 dB，即：  
$90 = 10\log_{10}\frac{2^{2B}}{3}$

$9 = \log_{10}\frac{2^{2B}}{3}$  

$10^9 = \frac{2^{2B}}{3}$  

$2^{2B} = 3 \times 10^9$  

$2B \log_{2} 2 = \log_{2}(3 \times 10^9)$

$2B = \log_{2}(3 \times 10^9)$  

$B = \frac{1}{2}\log_{2}(3 \times 10^9) \approx 15.8$  

由于 A/D 转换器的位数必须为整数，所以 A/D 转换器至少需要 16 位。
