# 第四章 连续时间信号采样与量化误差（Part2）

1. **连续时间信号的采样**

    * **采样过程与表示**

      * **周期采样**：连续时间信号$x_c(t)$通过周期采样离散化，采样周期为$T$，采样频率$f_s = 1/T$，采样后得到离散时间信号$x(n)=x_c(nT)$。理想采样时，采样脉冲为冲激函数序列$\delta_T(t)=\sum_{m = -\infty}^{\infty}\delta(t - mT)$，实际采样脉冲有一定延续时间$\tau$。采样信号$x_s(t)=x_c(t)\cdot\delta_T(t)=\sum_{m = -\infty}^{\infty}x_c(mT)\delta(t - mT)$。
      * **采样信号频谱**：采样信号$x_s(t)$的频谱$X_s(j\Omega)=\frac{1}{T}\sum_{k = -\infty}^{\infty}X_c(j(\Omega - k\Omega_s))$（$\Omega_s = 2\pi f_s$），表明采样后频谱是原信号频谱以采样频率$\Omega_s$为周期的延拓。
    * **采样定理**

      * **奈奎斯特采样定理**：为使采样后能无失真重构原始信号，采样频率$f_s$必须大于两倍原始信号频谱最高频率$f_h$（$\Omega_s>2\Omega_h$），$\Omega_s/2$为折叠频率。若不满足，会产生频谱混叠现象。
      * **抗混叠措施**：采样前常加入抗混叠低通滤波器，滤除高于$f_s/2$的频率分量，以避免频谱混叠。
    * **采样实例分析**

      * **计算采样序列**：如对于连续时间信号$x_c(t)=A\cos(200\pi t)+B\cos(500\pi t)$，以$f_s = 1kHz$采样，可计算出采样序列$x(n)=x_c(nT)=A\cos(\frac{\pi}{5}n)+B\cos(\frac{\pi}{2}n)$，其周期$N = 20$（参考例4 - 1）。
      * **由采样序列反推连续信号**：已知采样序列$x(n)=\cos(\frac{\pi}{8}n)$，通过分析可知产生该序列的连续时间信号可为$x_{c1}(t)=\cos(1250\pi t)$或$x_{c2}(t)=\cos(21250\pi t)$（参考例4 - 2）。
    * **实际采样讨论**

      * **实际采样脉冲频谱影响**：实际采样时，采样脉冲为矩形周期脉冲$p(t)$，将其展开成傅氏级数$p(t)=\sum_{k = -\infty}^{\infty}C_k e^{j\Omega_st}$（$\Omega_s = 2\pi f_s$），采样数据$x_s(t)$频谱为$X_s(j\Omega)=\sum_{k = -\infty}^{\infty}C_k X_c(j(\Omega - k\Omega_s))$。虽频谱是周期延拓，但包络随频率增加而下降，不过不影响信号重构，奈奎斯特采样定理仍适用（只要无频率混叠）。
      * **滤波与采样频率关系**：对连续时间信号$x_c(t)$滤波（如消除$5kHz<f<10kHz$之外频率成分，$x_c(t)$最高频率$20kHz$），可求最小采样频率和理想滤波器$H(j\Omega)$，最小采样频率为$40kHz$，理想滤波器$H(j\Omega)$在$10\pi\leq\Omega\leq20\pi$时为$T$，其他为$0$（参考例4 - 3）。
2. **量化误差分析**

    * **量化原理与过程**

      * **量化步骤**：连续时间信号经采样得到采样数据$x_s(t)$，再经幅度量化编码得到数字信号$x(n)$。A/D转换过程中，量化器将输入样本$x(n)$转换为有限集合值中的一个，量化样本$\hat{x}(n)=Q[x(n)]$，量化电平可均匀或非均匀间隔，实际多采用均匀量化。
      * **量化噪声产生**：量化过程中，由于量化器的有限分辨率，会引入量化误差，该误差可视为一种噪声，即量化噪声。
    * **量化噪声分析**

      * **量化噪声方差计算**：对于$(B + 1)$位量化器，量化阶$\Delta=\frac{2X_m}{2^{B + 1}}=\frac{X_m}{2^{B}}$（$X_m$为量化器的满幅度值），假设量化误差在$-\frac{\Delta}{2}$到$\frac{\Delta}{2}$之间均匀分布，其均值为零，方差$\sigma_{e}^{2}=\int_{-\Delta/2}^{\Delta/2}(e^{2}\frac{1}{\Delta})de=\frac{1}{12}\Delta^{2}=\frac{1}{12}\cdot2^{-2B}X_{m}^{2}$。
      * **信号与量化噪声比（SQNR）**

        * **公式**：$SQNR = 10\lg\frac{\sigma_{x}^{2}}{\sigma_{e}^{2}} = 10\lg\frac{\sigma_{x}^{2}}{\frac{1}{12}\cdot2^{-2B}X_{m}^{2}} = 10\lg\frac{12\cdot2^{2B}\sigma_{x}^{2}}{X_{m}^{2}} = 6.02B + 10.8 - 20\lg\frac{X_{m}}{\sigma_{x}}$（其中$\sigma_{x}^{2}$是信号的方差）。
        * **意义**：该比值反映了信号功率与量化噪声功率的相对大小，用于衡量量化对信号质量的影响。例如，在习题4 - 5中，根据给定的SQNR要求和信号方差、量化器量程等条件，可计算出所需的A/D转换器位数。在例4 - 7中，假设图像强度均匀分布在$[0,1]$上，计算出信号方差$\sigma_{x}^{2}=\frac{1}{12}$，再结合其他条件计算出满足一定信噪比要求所需的量化器位数等相关参数。
